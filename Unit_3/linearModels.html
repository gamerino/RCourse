<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>linearModels</title><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX","output/HTML-CSS"],
    extensions: ["[a11y]/accessibility-menu.js"],
    'HTML-CSS': {
      availableFonts: [],
      webFont: 'TeX',
      undefinedFamily: "serif",
      mtextFontInherit: true,
    },
    TeX: {
  "Macros": {},
  "equationNumbers": {},
  "extensions": [
    "AMSmath.js",
    "AMSsymbols.js",
    "noErrors.js",
    "noUndefined.js"
  ]
},
    showMathMenu: true
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
    <style>body { padding: 0; margin: 0; }
.markdown-preview-plus-view:not([data-use-github-style]) {
  padding: 2em;
  font-size: 1.2em;
  color: #657b83;
  background-color: #fdf6e3;
}
.markdown-preview-plus-view:not([data-use-github-style]) span.critic.comment > span {
  background-color: #fdf6e3;
}
.markdown-preview-plus-view:not([data-use-github-style]) > :first-child {
  margin-top: 0;
}
.markdown-preview-plus-view:not([data-use-github-style]) h1,
.markdown-preview-plus-view:not([data-use-github-style]) h2,
.markdown-preview-plus-view:not([data-use-github-style]) h3,
.markdown-preview-plus-view:not([data-use-github-style]) h4,
.markdown-preview-plus-view:not([data-use-github-style]) h5,
.markdown-preview-plus-view:not([data-use-github-style]) h6 {
  line-height: 1.2;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  color: #1e2427;
}
.markdown-preview-plus-view:not([data-use-github-style]) h1 {
  font-size: 2.4em;
  font-weight: 300;
}
.markdown-preview-plus-view:not([data-use-github-style]) h2 {
  font-size: 1.8em;
  font-weight: 400;
}
.markdown-preview-plus-view:not([data-use-github-style]) h3 {
  font-size: 1.5em;
  font-weight: 500;
}
.markdown-preview-plus-view:not([data-use-github-style]) h4 {
  font-size: 1.2em;
  font-weight: 600;
}
.markdown-preview-plus-view:not([data-use-github-style]) h5 {
  font-size: 1.1em;
  font-weight: 600;
}
.markdown-preview-plus-view:not([data-use-github-style]) h6 {
  font-size: 1em;
  font-weight: 600;
}
.markdown-preview-plus-view:not([data-use-github-style]) strong {
  color: #1e2427;
}
.markdown-preview-plus-view:not([data-use-github-style]) del {
  color: #90a3a9;
}
.markdown-preview-plus-view:not([data-use-github-style]) a,
.markdown-preview-plus-view:not([data-use-github-style]) a code {
  color: #002b36;
}
.markdown-preview-plus-view:not([data-use-github-style]) img {
  max-width: 100%;
}
.markdown-preview-plus-view:not([data-use-github-style]) > p {
  margin-top: 0;
  margin-bottom: 1.5em;
}
.markdown-preview-plus-view:not([data-use-github-style]) > ul,
.markdown-preview-plus-view:not([data-use-github-style]) > ol {
  margin-bottom: 1.5em;
}
.markdown-preview-plus-view:not([data-use-github-style]) blockquote {
  margin: 1.5em 0;
  font-size: inherit;
  color: #90a3a9;
  border-color: #f8de97;
  border-width: 4px;
}
.markdown-preview-plus-view:not([data-use-github-style]) hr {
  margin: 3em 0;
  border-top: 2px dashed #f8de97;
  background: none;
}
.markdown-preview-plus-view:not([data-use-github-style]) table {
  margin: 1.5em 0;
}
.markdown-preview-plus-view:not([data-use-github-style]) th {
  color: #1e2427;
}
.markdown-preview-plus-view:not([data-use-github-style]) th,
.markdown-preview-plus-view:not([data-use-github-style]) td {
  padding: 0.66em 1em;
  border: 1px solid #f8de97;
}
.markdown-preview-plus-view:not([data-use-github-style]) pre,
.markdown-preview-plus-view:not([data-use-github-style]) code {
  color: #1e2427;
  background-color: #fbedc6;
}
.markdown-preview-plus-view:not([data-use-github-style]) pre,
.markdown-preview-plus-view:not([data-use-github-style]) pre.editor-colors {
  margin: 1.5em 0;
  padding: 1em;
  font-size: 0.92em;
  border-radius: 3px;
  background-color: #fcf0d0;
}
.markdown-preview-plus-view:not([data-use-github-style]) kbd {
  color: #1e2427;
  border: 1px solid #f8de97;
  border-bottom: 2px solid #f6d47a;
  background-color: #fbedc6;
}

@include 'style-variables';
.markdown-preview-plus-view {
  display: block;
  overflow-x: hidden;
}
.markdown-preview-plus-view .emoji {
  max-width: 1em !important;
}
.markdown-preview-plus-view del {
  text-decoration: none;
  position: relative;
}
.markdown-preview-plus-view del::after {
  border-bottom: 1px solid black;
  content: '';
  left: 0;
  position: absolute;
  right: 0;
  top: 50%;
}
.markdown-preview-plus-view ul.contains-task-list li.task-list-item {
  position: relative;
  list-style-type: none;
}
.markdown-preview-plus-view ul.contains-task-list li.task-list-item input.task-list-item-checkbox {
  position: absolute;
  transform: translateX(-100%);
  width: 30px;
}
.markdown-preview-plus-view span.critic.comment {
  position: relative;
}
.markdown-preview-plus-view span.critic.comment::before {
  content: '\1f4ac';
  position: initial;
}
.markdown-preview-plus-view span.critic.comment > span {
  display: none;
}
.markdown-preview-plus-view span.critic.comment:hover > span {
  display: initial;
  position: absolute;
  top: 100%;
  left: 0;
  border: 1px solid;
  border-radius: 5px;
  max-height: 4em;
  overflow: auto;
}
.markdown-preview-plus-view span.critic.comment:focus > span {
  display: initial;
  text-decoration: underline;
  position: initial;
  top: auto;
  left: auto;
  border: initial;
  border-radius: initial;
}

body.markdown-preview-plus-view[data-use-github-style] {
  overflow: initial !important;
}
.markdown-preview-plus-view[data-use-github-style] {
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  line-height: 1.6;
  word-wrap: break-word;
  padding: 30px;
  font-size: 16px;
  color: #333;
  background-color: #fff;
}
.markdown-preview-plus-view[data-use-github-style] > *:first-child {
  margin-top: 0 !important;
}
.markdown-preview-plus-view[data-use-github-style] > *:last-child {
  margin-bottom: 0 !important;
}
.markdown-preview-plus-view[data-use-github-style] a:not([href]) {
  color: inherit;
  text-decoration: none;
}
.markdown-preview-plus-view[data-use-github-style] .absent {
  color: #c00;
}
.markdown-preview-plus-view[data-use-github-style] .anchor {
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}
.markdown-preview-plus-view[data-use-github-style] .anchor:focus {
  outline: none;
}
.markdown-preview-plus-view[data-use-github-style] h1,
.markdown-preview-plus-view[data-use-github-style] h2,
.markdown-preview-plus-view[data-use-github-style] h3,
.markdown-preview-plus-view[data-use-github-style] h4,
.markdown-preview-plus-view[data-use-github-style] h5,
.markdown-preview-plus-view[data-use-github-style] h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}
.markdown-preview-plus-view[data-use-github-style] h1 .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h2 .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h3 .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h4 .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h5 .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h6 .octicon-link {
  display: none;
  color: #000;
  vertical-align: middle;
}
.markdown-preview-plus-view[data-use-github-style] h1:hover .anchor,
.markdown-preview-plus-view[data-use-github-style] h2:hover .anchor,
.markdown-preview-plus-view[data-use-github-style] h3:hover .anchor,
.markdown-preview-plus-view[data-use-github-style] h4:hover .anchor,
.markdown-preview-plus-view[data-use-github-style] h5:hover .anchor,
.markdown-preview-plus-view[data-use-github-style] h6:hover .anchor {
  padding-left: 8px;
  margin-left: -30px;
  text-decoration: none;
}
.markdown-preview-plus-view[data-use-github-style] h1:hover .anchor .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h2:hover .anchor .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h3:hover .anchor .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h4:hover .anchor .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h5:hover .anchor .octicon-link,
.markdown-preview-plus-view[data-use-github-style] h6:hover .anchor .octicon-link {
  display: inline-block;
}
.markdown-preview-plus-view[data-use-github-style] h1 tt,
.markdown-preview-plus-view[data-use-github-style] h2 tt,
.markdown-preview-plus-view[data-use-github-style] h3 tt,
.markdown-preview-plus-view[data-use-github-style] h4 tt,
.markdown-preview-plus-view[data-use-github-style] h5 tt,
.markdown-preview-plus-view[data-use-github-style] h6 tt,
.markdown-preview-plus-view[data-use-github-style] h1 code,
.markdown-preview-plus-view[data-use-github-style] h2 code,
.markdown-preview-plus-view[data-use-github-style] h3 code,
.markdown-preview-plus-view[data-use-github-style] h4 code,
.markdown-preview-plus-view[data-use-github-style] h5 code,
.markdown-preview-plus-view[data-use-github-style] h6 code {
  font-size: inherit;
}
.markdown-preview-plus-view[data-use-github-style] h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}
.markdown-preview-plus-view[data-use-github-style] h1 .anchor {
  line-height: 1;
}
.markdown-preview-plus-view[data-use-github-style] h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}
.markdown-preview-plus-view[data-use-github-style] h2 .anchor {
  line-height: 1;
}
.markdown-preview-plus-view[data-use-github-style] h3 {
  font-size: 1.5em;
  line-height: 1.43;
}
.markdown-preview-plus-view[data-use-github-style] h3 .anchor {
  line-height: 1.2;
}
.markdown-preview-plus-view[data-use-github-style] h4 {
  font-size: 1.25em;
}
.markdown-preview-plus-view[data-use-github-style] h4 .anchor {
  line-height: 1.2;
}
.markdown-preview-plus-view[data-use-github-style] h5 {
  font-size: 1em;
}
.markdown-preview-plus-view[data-use-github-style] h5 .anchor {
  line-height: 1.1;
}
.markdown-preview-plus-view[data-use-github-style] h6 {
  font-size: 1em;
  color: #777;
}
.markdown-preview-plus-view[data-use-github-style] h6 .anchor {
  line-height: 1.1;
}
.markdown-preview-plus-view[data-use-github-style] p,
.markdown-preview-plus-view[data-use-github-style] blockquote,
.markdown-preview-plus-view[data-use-github-style] ul,
.markdown-preview-plus-view[data-use-github-style] ol,
.markdown-preview-plus-view[data-use-github-style] dl,
.markdown-preview-plus-view[data-use-github-style] table,
.markdown-preview-plus-view[data-use-github-style] pre {
  margin-top: 0;
  margin-bottom: 16px;
}
.markdown-preview-plus-view[data-use-github-style] hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}
.markdown-preview-plus-view[data-use-github-style] ul,
.markdown-preview-plus-view[data-use-github-style] ol {
  padding-left: 2em;
}
.markdown-preview-plus-view[data-use-github-style] ul.no-list,
.markdown-preview-plus-view[data-use-github-style] ol.no-list {
  padding: 0;
  list-style-type: none;
}
.markdown-preview-plus-view[data-use-github-style] ul ul,
.markdown-preview-plus-view[data-use-github-style] ul ol,
.markdown-preview-plus-view[data-use-github-style] ol ol,
.markdown-preview-plus-view[data-use-github-style] ol ul {
  margin-top: 0;
  margin-bottom: 0;
}
.markdown-preview-plus-view[data-use-github-style] li > p {
  margin-top: 16px;
}
.markdown-preview-plus-view[data-use-github-style] dl {
  padding: 0;
}
.markdown-preview-plus-view[data-use-github-style] dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}
.markdown-preview-plus-view[data-use-github-style] dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}
.markdown-preview-plus-view[data-use-github-style] blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}
.markdown-preview-plus-view[data-use-github-style] blockquote > :first-child {
  margin-top: 0;
}
.markdown-preview-plus-view[data-use-github-style] blockquote > :last-child {
  margin-bottom: 0;
}
.markdown-preview-plus-view[data-use-github-style] table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}
.markdown-preview-plus-view[data-use-github-style] table th {
  font-weight: bold;
}
.markdown-preview-plus-view[data-use-github-style] table th,
.markdown-preview-plus-view[data-use-github-style] table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}
.markdown-preview-plus-view[data-use-github-style] table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}
.markdown-preview-plus-view[data-use-github-style] table tr:nth-child(2n) {
  background-color: #f8f8f8;
}
.markdown-preview-plus-view[data-use-github-style] img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
.markdown-preview-plus-view[data-use-github-style] .emoji {
  max-width: none;
}
.markdown-preview-plus-view[data-use-github-style] span.frame {
  display: block;
  overflow: hidden;
}
.markdown-preview-plus-view[data-use-github-style] span.frame > span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid #ddd;
}
.markdown-preview-plus-view[data-use-github-style] span.frame span img {
  display: block;
  float: left;
}
.markdown-preview-plus-view[data-use-github-style] span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: #333;
}
.markdown-preview-plus-view[data-use-github-style] span.align-center {
  display: block;
  overflow: hidden;
  clear: both;
}
.markdown-preview-plus-view[data-use-github-style] span.align-center > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center;
}
.markdown-preview-plus-view[data-use-github-style] span.align-center span img {
  margin: 0 auto;
  text-align: center;
}
.markdown-preview-plus-view[data-use-github-style] span.align-right {
  display: block;
  overflow: hidden;
  clear: both;
}
.markdown-preview-plus-view[data-use-github-style] span.align-right > span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right;
}
.markdown-preview-plus-view[data-use-github-style] span.align-right span img {
  margin: 0;
  text-align: right;
}
.markdown-preview-plus-view[data-use-github-style] span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden;
}
.markdown-preview-plus-view[data-use-github-style] span.float-left span {
  margin: 13px 0 0;
}
.markdown-preview-plus-view[data-use-github-style] span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden;
}
.markdown-preview-plus-view[data-use-github-style] span.float-right > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right;
}
.markdown-preview-plus-view[data-use-github-style] code,
.markdown-preview-plus-view[data-use-github-style] tt {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0, 0, 0, 0.04);
  border-radius: 3px;
}
.markdown-preview-plus-view[data-use-github-style] code:before,
.markdown-preview-plus-view[data-use-github-style] tt:before,
.markdown-preview-plus-view[data-use-github-style] code:after,
.markdown-preview-plus-view[data-use-github-style] tt:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}
.markdown-preview-plus-view[data-use-github-style] code br,
.markdown-preview-plus-view[data-use-github-style] tt br {
  display: none;
}
.markdown-preview-plus-view[data-use-github-style] del code {
  text-decoration: inherit;
}
.markdown-preview-plus-view[data-use-github-style] pre > code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}
.markdown-preview-plus-view[data-use-github-style] .highlight {
  margin-bottom: 16px;
}
.markdown-preview-plus-view[data-use-github-style] .highlight pre,
.markdown-preview-plus-view[data-use-github-style] pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}
.markdown-preview-plus-view[data-use-github-style] .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}
.markdown-preview-plus-view[data-use-github-style] pre {
  word-wrap: normal;
}
.markdown-preview-plus-view[data-use-github-style] pre code,
.markdown-preview-plus-view[data-use-github-style] pre tt {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}
.markdown-preview-plus-view[data-use-github-style] pre code:before,
.markdown-preview-plus-view[data-use-github-style] pre tt:before,
.markdown-preview-plus-view[data-use-github-style] pre code:after,
.markdown-preview-plus-view[data-use-github-style] pre tt:after {
  content: normal;
}
.markdown-preview-plus-view[data-use-github-style] kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}
.markdown-preview-plus-view[data-use-github-style] span.critic.comment > span {
  background-color: #fff;
}
.markdown-preview-plus-view[data-use-github-style] a {
  color: #337ab7;
}
.markdown-preview-plus-view[data-use-github-style] pre,
.markdown-preview-plus-view[data-use-github-style] code {
  color: inherit;
}
.markdown-preview-plus-view[data-use-github-style] pre,
.markdown-preview-plus-view[data-use-github-style] pre.editor-colors {
  padding: 0.8em 1em;
  margin-bottom: 1em;
  font-size: 0.85em;
  border-radius: 4px;
  overflow: auto;
}

.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}
.line-number.bracket-matcher.bracket-matcher {
  color: #002b36;
  background-color: #dfd4b1;
}

.spell-check-misspelling .region {
  border-bottom: 2px dotted rgba(255, 51, 51, 0.75);
}
.spell-check-corrections {
  width: 25em !important;
}

pre.editor-colors {
  color: #657b83;
  background-color: #fdf6e3;
}
pre.editor-colors .gutter {
  color: #657b83;
  background-color: #eee8d5;
}
pre.editor-colors .gutter .line-number.cursor-line {
  background-color: #dfd4b1;
}
pre.editor-colors .invisible-character {
  color: #dcd0a9;
}
pre.editor-colors .indent-guide {
  color: #dcd0a9;
}
pre.editor-colors .cursor {
  border-color: #002b36;
}
pre.editor-colors .selection .region {
  background-color: #eee8d5;
}
pre.editor-colors .fold-marker:after,
pre.editor-colors .gutter .line-number.folded {
  color: #d33682;
}
pre.editor-colors .bracket-matcher .region {
  border-color: #d33682;
}
.syntax--comment {
  color: #93a1a1;
  font-style: italic;
}
.syntax--comment .syntax--markup.syntax--link {
  color: #93a1a1;
}
.syntax--string {
  color: #2aa198;
}
.syntax--string.syntax--regexp {
  color: #dc322f;
}
.syntax--constant.syntax--numeric {
  color: #d33682;
}
.syntax--constant.syntax--language {
  color: #b58900;
}
.syntax--constant.syntax--character,
.syntax--constant.syntax--other {
  color: #cb4b16;
}
.syntax--variable {
  color: #268bd2;
}
.syntax--keyword {
  color: #859900;
}
.syntax--storage {
  color: #859900;
}
.syntax--entity.syntax--name.syntax--class,
.syntax--entity.syntax--name.syntax--type,
.syntax--entity.syntax--name.syntax--function {
  color: #268bd2;
}
.syntax--entity.syntax--other.syntax--attribute-name {
  color: #657b83;
}
.syntax--support.syntax--function {
  color: #268bd2;
}
.syntax--support.syntax--function.syntax--builtin {
  color: #859900;
}
.syntax--support.syntax--type,
.syntax--support.syntax--class {
  color: #859900;
}
.syntax--tag.syntax--entity.syntax--name {
  color: #268bd2;
}
.syntax--tag.syntax--punctuation.syntax--definition.syntax--html,
.syntax--tag.syntax--punctuation.syntax--definition.syntax--begin,
.syntax--tag.syntax--punctuation.syntax--definition.syntax--end {
  color: #93a1a1;
}
.syntax--invalid.syntax--deprecated {
  color: #b58900;
  text-decoration: underline;
}
.syntax--invalid.syntax--illegal {
  color: #dc322f;
  text-decoration: underline;
}
.syntax--none {
  color: #657b83;
}
.syntax--source.syntax--c .syntax--meta.syntax--preprocessor,
.syntax--source.syntax--cpp .syntax--meta.syntax--preprocessor {
  color: #dc322f;
}
.syntax--source.syntax--c .syntax--keyword.syntax--control.syntax--directive,
.syntax--source.syntax--cpp .syntax--keyword.syntax--control.syntax--directive {
  color: #cb4b16;
}
.syntax--source.syntax--c .syntax--punctuation.syntax--string,
.syntax--source.syntax--cpp .syntax--punctuation.syntax--string {
  color: #2aa198;
}
.syntax--source.syntax--c .syntax--constant,
.syntax--source.syntax--cpp .syntax--constant {
  color: #cb4b16;
}
.syntax--source.syntax--c .syntax--constant.syntax--numeric,
.syntax--source.syntax--cpp .syntax--constant.syntax--numeric,
.syntax--source.syntax--c .syntax--constant.syntax--language.syntax--c,
.syntax--source.syntax--cpp .syntax--constant.syntax--language.syntax--c {
  color: #2aa198;
}
.syntax--source.syntax--c .syntax--storage,
.syntax--source.syntax--cpp .syntax--storage {
  color: #b58900;
}
.syntax--source.syntax--c .syntax--entity,
.syntax--source.syntax--cpp .syntax--entity {
  color: #657b83;
}
.syntax--source.syntax--c .syntax--entity.syntax--name.syntax--function.syntax--preprocessor,
.syntax--source.syntax--cpp .syntax--entity.syntax--name.syntax--function.syntax--preprocessor {
  color: #dc322f;
}
.syntax--source.syntax--c .syntax--support.syntax--type,
.syntax--source.syntax--cpp .syntax--support.syntax--type {
  color: #b58900;
}
.syntax--source.syntax--c .syntax--support.syntax--type.syntax--posix-reserved,
.syntax--source.syntax--cpp .syntax--support.syntax--type.syntax--posix-reserved {
  color: #657b83;
}
.syntax--source.syntax--c .syntax--variable.syntax--other.syntax--dot-access,
.syntax--source.syntax--cpp .syntax--variable.syntax--other.syntax--dot-access {
  color: #657b83;
}
.syntax--source.syntax--c .syntax--variable.syntax--parameter.syntax--preprocessor,
.syntax--source.syntax--cpp .syntax--variable.syntax--parameter.syntax--preprocessor {
  color: #dc322f;
}
.syntax--source.syntax--coffee .syntax--support.syntax--class {
  color: #859900;
}
.syntax--source.syntax--coffee .syntax--variable,
.syntax--source.syntax--coffee .syntax--entity.syntax--name.syntax--function,
.syntax--source.syntax--coffee .syntax--entity.syntax--name.syntax--class {
  color: #268bd2;
}
.syntax--source.syntax--coffee .syntax--variable.syntax--parameter.syntax--function {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--variable.syntax--other.syntax--readwrite {
  color: #859900;
}
.syntax--source.syntax--coffee .syntax--storage.syntax--type.syntax--function {
  color: #859900;
}
.syntax--source.syntax--coffee .syntax--entity.syntax--name {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--meta.syntax--brace.syntax--round,
.syntax--source.syntax--coffee .syntax--meta.syntax--brace.syntax--square {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--meta.syntax--delimiter {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--storage.syntax--type.syntax--class {
  color: #859900;
}
.syntax--source.syntax--coffee .syntax--punctuation.syntax--terminator {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--punctuation.syntax--section.syntax--embedded {
  color: #dc322f;
}
.syntax--source.syntax--coffee .syntax--embedded.syntax--source {
  color: #657b83;
}
.syntax--source.syntax--coffee .syntax--constant.syntax--numeric {
  color: #d33682;
}
.syntax--source.syntax--coffee .syntax--constant.syntax--language.syntax--boolean {
  color: #b58900;
}
.syntax--source.syntax--css .syntax--punctuation.syntax--separator,
.syntax--source.syntax--css .syntax--punctuation.syntax--terminator {
  color: #657b83;
}
.syntax--source.syntax--css .syntax--punctuation.syntax--property-list.syntax--begin,
.syntax--source.syntax--css .syntax--punctuation.syntax--property-list.syntax--end {
  color: #dc322f;
}
.syntax--source.syntax--css .syntax--punctuation.syntax--section.syntax--function {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--entity.syntax--name {
  color: #859900;
}
.syntax--source.syntax--css .syntax--attribute-name.syntax--class,
.syntax--source.syntax--css .syntax--id {
  color: #268bd2;
}
.syntax--source.syntax--css .syntax--pseudo-element,
.syntax--source.syntax--css .syntax--pseudo-class {
  color: #cb4b16;
}
.syntax--source.syntax--css .syntax--property-value {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--constant.syntax--numeric {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--constant.syntax--numeric .syntax--unit {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--rgb-value {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--support.syntax--constant {
  color: #2aa198;
}
.syntax--source.syntax--css .syntax--support.syntax--constant.syntax--media {
  color: #dc322f;
}
.syntax--source.syntax--css .syntax--keyword.syntax--important {
  color: #dc322f;
}
.syntax--source.syntax--less .syntax--keyword.syntax--unit,
.syntax--source.syntax--scss .syntax--keyword.syntax--unit {
  color: #2aa198;
}
.syntax--source.syntax--go .syntax--operator {
  color: #657b83;
}
.syntax--source.syntax--go .syntax--operator.syntax--assignment {
  color: #859900;
}
.syntax--source.syntax--java .syntax--keyword.syntax--operator {
  color: #859900;
}
.syntax--source.syntax--java .syntax--keyword.syntax--import {
  color: #cb4b16;
}
.syntax--source.syntax--java .syntax--storage.syntax--modifier.syntax--import {
  color: #93a1a1;
}
.syntax--source.syntax--java .syntax--meta.syntax--class .syntax--storage.syntax--modifier {
  color: #b58900;
}
.syntax--source.syntax--java .syntax--meta.syntax--class .syntax--meta.syntax--class.syntax--identifier .syntax--entity.syntax--name.syntax--type.syntax--class {
  color: #268bd2;
}
.syntax--source.syntax--java .syntax--storage.syntax--type.syntax--primitive.syntax--array {
  color: #859900;
}
.syntax--source.syntax--java .syntax--constant.syntax--numeric {
  color: #d33682;
}
.syntax--source.syntax--java .syntax--constant.syntax--other {
  color: #cb4b16;
}
.syntax--source.syntax--java .syntax--storage.syntax--type {
  color: #859900;
}
.syntax--source.syntax--java .syntax--meta.syntax--method-call {
  color: #dc322f;
}
.syntax--source.syntax--java .syntax--meta.syntax--method-call .syntax--meta.syntax--method {
  color: #6c71c4;
}
.syntax--source.syntax--java .syntax--meta.syntax--method-call .syntax--punctuation.syntax--definition.syntax--seperator.syntax--parameter {
  color: #859900;
}
.syntax--source.syntax--java .syntax--punctuation.syntax--definition.syntax--method-parameters {
  color: #586e75;
}
.syntax--source.syntax--js .syntax--constant {
  color: #859900;
}
.syntax--source.syntax--js .syntax--comma {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--support.syntax--class {
  color: #859900;
}
.syntax--source.syntax--js .syntax--entity.syntax--name.syntax--type {
  color: #b58900;
}
.syntax--source.syntax--js .syntax--entity.syntax--name {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--meta.syntax--brace {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--keyword {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--new {
  color: #859900;
}
.syntax--source.syntax--js .syntax--keyword.syntax--control {
  color: #859900;
}
.syntax--source.syntax--js .syntax--keyword.syntax--control.syntax--regexp {
  color: #2aa198;
}
.syntax--source.syntax--js .syntax--variable {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--variable.syntax--dom {
  color: #859900;
}
.syntax--source.syntax--js .syntax--delimiter + .syntax--dom {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--name {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--variable.syntax--language {
  color: #268bd2;
}
.syntax--source.syntax--js .syntax--variable.syntax--parameter {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--regexp {
  color: #2aa198;
}
.syntax--source.syntax--js .syntax--support.syntax--function {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--support.syntax--constant {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--storage {
  color: #268bd2;
}
.syntax--source.syntax--js .syntax--constant.syntax--numeric {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--punctuation.syntax--terminator.syntax--statement {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--meta.syntax--delimiter.syntax--method.syntax--period {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--meta.syntax--brace.syntax--square {
  color: #268bd2;
}
.syntax--source.syntax--js .syntax--meta.syntax--brace.syntax--curly {
  color: #268bd2;
}
.syntax--source.syntax--js .syntax--definition.syntax--begin.syntax--curly,
.syntax--source.syntax--js .syntax--definition.syntax--end.syntax--curly {
  color: #268bd2;
}
.syntax--source.syntax--js .syntax--string.syntax--quoted.syntax--template .syntax--embedded.syntax--source {
  color: #657b83;
}
.syntax--source.syntax--js .syntax--string.syntax--quoted.syntax--template .syntax--embedded.syntax--source > .syntax--embedded.syntax--punctuation {
  color: #dc322f;
}
.syntax--source.syntax--js.syntax--embedded .syntax--entity.syntax--name.syntax--tag {
  color: #268bd2;
}
.syntax--source.syntax--js.syntax--jsx .syntax--entity.syntax--name.syntax--tag {
  color: #268bd2;
}
.syntax--gfm .syntax--link .syntax--entity {
  color: #6c71c4;
}
.syntax--gfm .syntax--list.syntax--ordered {
  color: #859900;
}
.syntax--gfm .syntax--list.syntax--unordered {
  color: #b58900;
}
.syntax--gfm .syntax--raw {
  font-style: italic;
}
.syntax--gfm.syntax--support {
  color: #93a1a1;
}
.syntax--gfm.syntax--support.syntax--quote {
  color: #6c71c4;
}
.syntax--markup.syntax--bold {
  font-weight: bold;
}
.syntax--markup.syntax--italic {
  font-style: italic;
}
.syntax--markup.syntax--heading {
  color: #268bd2;
}
.syntax--markup.syntax--link {
  color: #2aa198;
}
.syntax--markup.syntax--deleted {
  color: #dc322f;
}
.syntax--markup.syntax--changed {
  color: #b58900;
}
.syntax--markup.syntax--inserted {
  color: #2aa198;
}
.syntax--source.syntax--php .syntax--storage.syntax--type.syntax--class {
  color: #b58900;
}
.syntax--source.syntax--php .syntax--storage.syntax--type.syntax--function {
  color: #cb4b16;
}
.syntax--source.syntax--php .syntax--storage.syntax--modifier {
  color: #b58900;
}
.syntax--source.syntax--php .syntax--entity.syntax--name.syntax--type.syntax--class {
  color: #657b83;
}
.syntax--source.syntax--php .syntax--entity.syntax--name.syntax--function {
  color: #657b83;
}
.syntax--source.syntax--php .syntax--entity.syntax--other {
  color: #657b83;
}
.syntax--source.syntax--php .syntax--variable {
  color: #268bd2;
}
.syntax--source.syntax--php .syntax--punctuation.syntax--definition {
  color: #657b83;
}
.syntax--source.syntax--php .syntax--punctuation.syntax--definition.syntax--comment {
  color: #93a1a1;
}
.syntax--source.syntax--php .syntax--punctuation.syntax--definition.syntax--array {
  color: #dc322f;
}
.syntax--source.syntax--php .syntax--punctuation.syntax--definition.syntax--string {
  color: #657b83;
}
.syntax--source.syntax--php .syntax--punctuation.syntax--definition.syntax--variable {
  color: #859900;
}
.syntax--source.syntax--php .syntax--support.syntax--function.syntax--construct {
  color: #b58900;
}
.syntax--source.syntax--php .syntax--support.syntax--function.syntax--array {
  color: #859900;
}
.syntax--source.syntax--php .syntax--keyword.syntax--operator.syntax--class {
  color: #b58900;
}
.syntax--source.syntax--php .syntax--keyword.syntax--operator.syntax--assignment {
  color: #859900;
}
.syntax--source.syntax--php .syntax--keyword.syntax--other {
  color: #dc322f;
}
.syntax--source.syntax--python .syntax--entity {
  color: #657b83;
}
.syntax--source.syntax--python .syntax--entity.syntax--name {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--entity.syntax--other {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--function {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--function.syntax--magic {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--punctuation.syntax--string {
  color: #2aa198;
}
.syntax--source.syntax--python .syntax--keyword.syntax--operator {
  color: #657b83;
}
.syntax--source.syntax--python .syntax--keyword.syntax--operator.syntax--quantifier {
  color: #2aa198;
}
.syntax--source.syntax--python .syntax--keyword.syntax--operator.syntax--logical {
  color: #859900;
}
.syntax--source.syntax--python .syntax--keyword.syntax--control.syntax--import {
  color: #cb4b16;
}
.syntax--source.syntax--python .syntax--keyword.syntax--other {
  color: #859900;
}
.syntax--source.syntax--python .syntax--constant.syntax--language {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--constant.syntax--character {
  color: #2aa198;
}
.syntax--source.syntax--python .syntax--constant.syntax--other {
  color: #dc322f;
}
.syntax--source.syntax--python .syntax--entity.syntax--name.syntax--type.syntax--class {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--variable {
  color: #657b83;
}
.syntax--source.syntax--python .syntax--support.syntax--function.syntax--builtin {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--support.syntax--type.syntax--exception.syntax--python {
  color: #b58900;
}
.syntax--source.syntax--python .syntax--support.syntax--type.syntax--python {
  color: #268bd2;
}
.syntax--source.syntax--python .syntax--storage.syntax--type.syntax--string {
  color: #2aa198;
}
.syntax--source.syntax--python .syntax--storage.syntax--type.syntax--class {
  color: #859900;
}
.syntax--source.syntax--python .syntax--storage.syntax--type.syntax--class.syntax--todo {
  color: #d33682;
}
.syntax--source.syntax--python .syntax--storage.syntax--type.syntax--function {
  color: #859900;
}
.syntax--source.syntax--python .syntax--punctuation.syntax--definition.syntax--parameters {
  color: #657b83;
}
.syntax--source.syntax--python .syntax--punctuation.syntax--section.syntax--function.syntax--begin {
  color: #657b83;
}
.syntax--source.syntax--python .syntax--punctuation.syntax--separator.syntax--parameters {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--meta.syntax--embedded .syntax--punctuation.syntax--section {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--punctuation.syntax--definition {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--punctuation.syntax--definition.syntax--string {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--punctuation.syntax--definition.syntax--comment {
  color: #93a1a1;
}
.syntax--source.syntax--ruby .syntax--entity.syntax--inherited-class {
  color: #b58900;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--parameter {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--constant {
  color: #b58900;
}
.syntax--source.syntax--ruby .syntax--constant.syntax--boolean {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--instance .syntax--punctuation.syntax--definition {
  color: #268bd2;
}
.syntax--source.syntax--ruby .syntax--class {
  color: #b58900;
}
.syntax--source.syntax--ruby .syntax--class.syntax--control {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--module {
  color: #b58900;
}
.syntax--source.syntax--ruby .syntax--require .syntax--keyword.syntax--other.syntax--special-method {
  color: #cb4b16;
}
.syntax--source.syntax--ruby .syntax--keyword.syntax--other.syntax--special-method {
  color: #cb4b16;
}
.syntax--source.syntax--ruby .syntax--keyword.syntax--other {
  color: #859900;
}
.syntax--source.syntax--ruby .syntax--keyword.syntax--control {
  color: #859900;
}
.syntax--source.syntax--ruby .syntax--keyword.syntax--operator {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--special-method {
  color: #268bd2;
}
.syntax--source.syntax--ruby .syntax--symbol {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--symbol .syntax--punctuation.syntax--definition {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--hashkey {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--hashkey .syntax--punctuation.syntax--definition {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--string.syntax--regexp {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--todo {
  color: #d33682;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--ruby.syntax--global {
  color: #268bd2;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--ruby.syntax--global .syntax--punctuation {
  color: #268bd2;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--block {
  color: #268bd2;
}
.syntax--source.syntax--ruby .syntax--variable.syntax--self {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--punctuation.syntax--separator {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--numeric {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--punctuation.syntax--section.syntax--regexp {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--string.syntax--interpolated {
  color: #2aa198;
}
.syntax--source.syntax--ruby .syntax--string.syntax--interpolated .syntax--embedded.syntax--line.syntax--ruby .syntax--punctuation .syntax--source.syntax--ruby {
  color: #dc322f;
}
.syntax--source.syntax--ruby .syntax--string.syntax--interpolated .syntax--embedded.syntax--line.syntax--ruby .syntax--source.syntax--ruby {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--string.syntax--interpolated .syntax--embedded.syntax--line.syntax--ruby .syntax--source.syntax--ruby .syntax--punctuation.syntax--array,
.syntax--source.syntax--ruby .syntax--string.syntax--interpolated .syntax--embedded.syntax--line.syntax--ruby .syntax--source.syntax--ruby .syntax--punctuation.syntax--function {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--support.syntax--function {
  color: #657b83;
}
.syntax--source.syntax--ruby .syntax--support.syntax--function.syntax--kernel {
  color: #859900;
}
.syntax--source.syntax--scala .syntax--variable {
  color: #586e75;
}
.syntax--source.syntax--scala .syntax--declaration {
  color: #586e75;
  font-weight: bold;
}
.syntax--source.syntax--scala .syntax--comparison {
  color: #586e75;
}
.syntax--source.syntax--scala .syntax--class,
.syntax--source.syntax--scala .syntax--type {
  color: #b58900;
}
.syntax--source.syntax--scala .syntax--val {
  font-weight: normal;
}
.syntax--source.syntax--scala .syntax--variable {
  font-weight: bold;
}
.syntax--source.syntax--scala .syntax--variable.syntax--parameter {
  color: #6c71c4;
  font-weight: normal;
}
.syntax--source.syntax--scala .syntax--control.syntax--flow {
  color: #586e75;
  font-weight: bold;
}
.syntax--source.syntax--scala .syntax--constant.syntax--language {
  color: #586e75;
  font-weight: bold;
}
.syntax--source.syntax--scala .syntax--function.syntax--declaration {
  color: #6c71c4;
}
.syntax--source.syntax--scala .syntax--modifier.syntax--other {
  font-weight: bold;
}
.syntax--source.syntax--scala .syntax--package {
  color: #586e75;
}
.syntax--source.syntax--scala .syntax--variable.syntax--import {
  font-weight: normal;
}
.syntax--source.syntax--scala .syntax--type .syntax--bounds,
.syntax--source.syntax--scala .syntax--type .syntax--class {
  color: #6c71c4;
}
.syntax--source.syntax--scala .syntax--documentation :not(.syntax--embedded).syntax--link.syntax--entity {
  color: #268bd2;
  text-decoration: underline;
}
.syntax--source.syntax--scala .syntax--documentation :not(.syntax--embedded) .syntax--class,
.syntax--source.syntax--scala .syntax--documentation :not(.syntax--embedded) .syntax--parameter {
  color: #586e75;
}
.syntax--source.syntax--scala .syntax--documentation :not(.syntax--embedded) .syntax--description {
  color: #93a1a1;
}
.syntax--source.syntax--scala .syntax--embedded {
  color: #374549;
  font-style: italic;
}
.syntax--source.syntax--scala .syntax--embedded .syntax--margin,
.syntax--source.syntax--scala .syntax--embedded .syntax--delimiters {
  font-style: normal;
}
</style>

  </head>
  <body class="markdown-preview-plus-view">
    <h1>Unidad 3: Modelos lineales en R</h1>
<p>En esta unidad se estudiarán los modelos lineales, su uso, ajuste e implementación así como también su evaluación en el entorno <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code>.</p>
<h2>Conceptos previos</h2>
<p>Un vector n-dimensional, <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span>, es un <em>Vector Aleatorio</em> si cada uno de sus elementos es una <em>Variable Aleatoria</em>. La <em>función de distribución</em> de un vector aleatorio es la <em>función de distribución conjunta</em> de sus elementos. Es así que la <em>esperanza</em> de un vector aleatorio es el vector de las esperanzas de sus elementos:</p>
<center>
<p><span class="math"><script type="math/tex">E(\boldsymbol{Y})=\begin{bmatrix} E(Y_1) \\ E(Y_2) \\ ...\\ E(Y_n) \end{bmatrix}=\begin{bmatrix} \mu_1\\ \mu_2 \\ ... \\ \mu_n\end{bmatrix}=\boldsymbol{\mu}</script></span></p>
</center>
<p>La <em>varianza</em> de un vector aleatorio se define como:</p>
<center>
<p><span class="math"><script type="math/tex">V(\boldsymbol{Y})= E((\boldsymbol{Y}-E(\boldsymbol{Y}))(\boldsymbol{Y}-E(\boldsymbol{Y}))^T)=\boldsymbol{\Sigma}=\begin{bmatrix} \sigma_{11} & \sigma_{12} & ... & \sigma_{1n} \\ \sigma_{12} & \sigma_{22} & ... & \sigma_{2n} \\ ... & ... & ... & ... \\ \sigma_{1n} & \sigma_{2n} & ... & \sigma_{nn} \end{bmatrix}</script></span></p>
</center>
<p><span class="math"><script type="math/tex">\boldsymbol{\Sigma}</script></span> es una matriz simétrica de <span class="math"><script type="math/tex">n</script></span>x<span class="math"><script type="math/tex">n</script></span> conocida como <em>matriz de varianzas y covarianzas</em>, <span class="math"><script type="math/tex">\sigma_{ii}=\sigma^2_i</script></span>, con <span class="math"><script type="math/tex">i=1,~...,~n</script></span> es la varianza de la i-ésima variable aleatoria del vector <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span> y <span class="math"><script type="math/tex">\sigma_{ij}</script></span> es la covarianza entre el i-ésimo y el j-ésimo elemento de <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span>.</p>
<p>Las propiedades básicas de la esperanza y varianza de transformaciones lineales se
pueden anticipar desde el caso univariado. Si <span class="math"><script type="math/tex">\boldsymbol{A}</script></span> es una matriz <span class="math"><script type="math/tex">q</script></span>x<span class="math"><script type="math/tex">n</script></span> y <span class="math"><script type="math/tex">\boldsymbol{c}</script></span> un vector de constantes <span class="math"><script type="math/tex">q</script></span>x<span class="math"><script type="math/tex">1</script></span>, entonces:</p>
<center>
<p><span class="math"><script type="math/tex">E(\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c})= \begin{bmatrix} E(\sum\limits_{j=1}^n a_{1j}Y_j + c_1) \\ E(\sum\limits_{j=1}^n a_{2j}Y_j + c_2) \\ ... \\ E(\sum\limits_{j=1}^n a_{nj}Y_j +c_n)\end{bmatrix}=\begin{bmatrix} \sum\limits_{j=1}^n a_{1j}E(Y_j) + c_1 \\ \sum\limits_{j=1}^n a_{2j}E(Y_j) + c_2 \\ ... \\ \sum\limits_{j=1}^n a_{nj}E(Y_j) +c_n\end{bmatrix}=\begin{bmatrix} \sum\limits_{j=1}^n a_{1j}\mu_j + c_1 \\ \sum\limits_{j=1}^n a_{2j}E\mu_j + c_2 \\ ... \\ \sum\limits_{j=1}^n a_{nj}\mu_j +c_n\end{bmatrix}= \boldsymbol{A}\boldsymbol{\mu}+\boldsymbol{c}</script></span></p>
</center>
<center>
<p><span class="math"><script type="math/tex">V(\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c})= E(((\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c})-E(\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c}))((\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c})-E(\boldsymbol{A}\boldsymbol{Y}+\boldsymbol{c}))^T)=\boldsymbol{A}\boldsymbol{\Sigma}\boldsymbol{A}^T</script></span></p>
</center>
<p>Particularmente, si las variables aleatorias que conforman el vector aleatorio <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span> son independientes y todas se distribuyen según <span class="math"><script type="math/tex">Y_i \sim N(\mu_i, \sigma^2)</script></span>, el vector aleatorio tiene distribución <em>normal multivariada</em> tal que <span class="math"><script type="math/tex">\boldsymbol{Y} \sim N(\boldsymbol{\mu}, \boldsymbol{\Sigma})</script></span>. Además, la independencia de los elementos del vector aleatorio determina que <span class="math"><script type="math/tex">\boldsymbol{\Sigma}</script></span> sea una matriz diagonal, definida positiva. La función de densidad conjunta de los elementos de <span class="math"><script type="math/tex">\boldsymbol{y}</script></span> está dada por:</p>
<center>
<p><span class="math"><script type="math/tex">f(\boldsymbol{Y})=f(Y_1)f(Y_2)...f(Y_n)=\prod\limits_{i=1}^n( (2\pi)^{-\frac{1}{2}}\sigma_ie^{-\frac{(Y_i-\mu_i)^2}{2\sigma^2_i}})=(2\pi)^{-\frac{n}{2}}\prod\limits_{i=1}^n(\sigma_i)e^{-\frac{1}{2}\sum\limits_{i=1}^n\frac{(Y_i-\mu_i)^2}{\sigma^2_i}})= (2\pi)^{-\frac{n}{2}}|\Sigma|^{-\frac{1}{2}}e^{-\frac{1}{2}[(\boldsymbol{Y}-\boldsymbol{\mu})^T \boldsymbol{\Sigma}(\boldsymbol{Y}-\boldsymbol{\mu})]})</script></span></p>
</center>
<h2>Introducción a los Modelos lineales</h2>
<p>Un <em>modelo estadístico</em> es una representación idealizada para explicar un proceso que genera datos. Usualmente, está representado mediante una ecuación o series de ecuaciones que involucra un número de <em>parámetros</em>. En términos generales, los modelos pueden utilizarse tanto para <em>predecir</em> el valor de una VA  o para <em>inferir</em> las relaciones existentes entre ciertas variables y una VA. Supongamos que queremos modelar el valor de una <em>variable respuesta</em> continua, <span class="math"><script type="math/tex">Y</script></span> en función de los valores de <span class="math"><script type="math/tex">l</script></span> variables <em>predictoras</em>, <em>regresoras</em> o <em>covariables</em>, <span class="math"><script type="math/tex">x_1</script></span>, <span class="math"><script type="math/tex">x_2</script></span>, …, <span class="math"><script type="math/tex">x_l</script></span>, para lo cual es posible definir la ecuación:</p>
<center>
<p><span class="math"><script type="math/tex">Y=f(x_1,~x_2,~...,~x_l)+\epsilon</script></span></p>
</center>
<p><span class="math"><script type="math/tex">f</script></span> es la función que relaciona la variable respuesta con las predictoras y <span class="math"><script type="math/tex">\epsilon</script></span> es el término de <em>error</em> que comete el modelo al representar el fenómeno real. Particularmente, pensemos en un modelo cuya ecuación define una <em>relación</em> entre un valor de la variable respuesta y valores de las predictoras o funciones de éstas, mediada por <em>coeficientes desconocidos</em>, <span class="math"><script type="math/tex">\beta_1</script></span>, <span class="math"><script type="math/tex">\beta_2</script></span>, …, <span class="math"><script type="math/tex">\beta_p</script></span>:</p>
<center>
<p><span class="math"><script type="math/tex">Y_i=\mu_i(\boldsymbol{x}_i\boldsymbol{\beta})+\epsilon_i</script></span></p>
</center>
<p>Más específicamente este modelo nos dice que el valor de <span class="math"><script type="math/tex">Y</script></span>, <span class="math"><script type="math/tex">Y_i</script></span>, resulta de sumarle un término aleatorio <span class="math"><script type="math/tex">\epsilon_i</script></span> a su esperanza <span class="math"><script type="math/tex">\mu</script></span>, la cual depende tanto de los valores observados para las covariables (<span class="math"><script type="math/tex">\boldsymbol{x}_i</script></span>) como de un vector de parámetros desconocidos (<span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span>). En base a esta ecuación es posible definir entonces un <strong>modelo lineal</strong>.</p>
<h3>Formulación del modelo lineal</h3>
<p>Este tipo de modelo se caracteriza por varios aspectos:</p>
<ul>
<li>
<p><span class="math"><script type="math/tex">Y_i</script></span> se asume con distribución normal.</p>
</li>
<li>
<p>la relación existente entre <span class="math"><script type="math/tex">Y_i</script></span> y las covariables o funciones de éstas es <em>lineal</em> en término de los parámetros del modelo, es decir:</p>
</li>
</ul>
<center>
<p><span class="math"><script type="math/tex">Y_i=q_0(\boldsymbol{x}_i)\beta_0+q_1(\boldsymbol{x}_i)\beta_1+q_2(\boldsymbol{x}_i)\beta_2+...+q_{p-1}(\boldsymbol{x}_i)\beta_{p-1}+\epsilon_i</script></span></p>
</center>
<ul>
<li>el término de error se asume con distribución normal de esperanza 0 y varianza <span class="math"><script type="math/tex">\sigma^2</script></span>, usualmente desconocida.</li>
</ul>
<p><strong>Pregunta</strong>: Cuál sería un ejemplo de un modelo no lineal? Considere la ecuación <span class="math"><script type="math/tex">Y_i=\beta_0+\beta_1x_1+\beta_2x_1^2</script></span>, representa un modelo lineal?</p>
<p>Cabe destacar que los <span class="math"><script type="math/tex">x_i</script></span> se asumen constantes fijas y conocidas, por eso se denotan con letras minúsculas. Mientras, la variable respuesta, <span class="math"><script type="math/tex">Y_i</script></span> es una VA, debido a que depende de <span class="math"><script type="math/tex">\epsilon_i</script></span>, que es una VA. Es por eso que a la variable respuesta se denota con mayúsculas.</p>
<p>Tomemos como ejemplo un caso sencillo, <span class="math"><script type="math/tex">\mu_i(\boldsymbol{x}_i\boldsymbol{\beta})=\beta_0+\beta_1x_i=E(Y_i|x_i)</script></span>, esto es <span class="math"><script type="math/tex">q_0=1</script></span> y <span class="math"><script type="math/tex">q_1=x</script></span>. En este caso, <span class="math"><script type="math/tex">E(Y_i|\boldsymbol{x}_i)</script></span> tendrá la forma de una recta con ordenada al origen <span class="math"><script type="math/tex">\beta_0</script></span> y pendiente <span class="math"><script type="math/tex">\beta_1</script></span>. Aunque este es un ejemplo sencillo, las curvas y superficies que pueden modelarse mediante los modelos lineales pueden ser muy diversas. El problema de encontrar, expresiones para superficies muy estructurada radica en la dificultad de identificar las funciones q_j (.), que no siempre pueden justificarse. Las formas más comunes de <span class="math"><script type="math/tex">q_j(.)</script></span> son <span class="math"><script type="math/tex">q_0(.)=1</script></span> y <span class="math"><script type="math/tex">q_j(\boldsymbol{x}_i)=x_{ij}</script></span>, <span class="math"><script type="math/tex">j>0</script></span>. De esta manera, el modelo lineal queda expresado como:</p>
<center>
<p><span class="math"><script type="math/tex">Y_i=\beta_0+x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ip-1}\beta_{p-1}+\epsilon_i</script></span></p>
</center>
<p>Otras formas comúnes son:</p>
<center>
<p><span class="math"><script type="math/tex">Y_i=\beta_0+x_{i1}\beta_1+x_{i1}^2\beta_2+...+x_{i\frac{p-1}{2}}\beta_{p-2}+x_{i\frac{p-1}{2}}^2\beta_{p-1}+\epsilon_i</script></span></p>
<p><span class="math"><script type="math/tex">Y_i=\beta_0+x_{i1}\beta_1+x_{i2}\beta_2+x_{i1}x_{i2}\beta_3...+x_{il}x_{il-1}\beta_{p-1}+\epsilon_i</script></span></p>
</center>
<p>La elección de las funciones <span class="math"><script type="math/tex">q_j(.)</script></span> depende del objetivo del modelo lineal, <em>predicción</em> o <em>inferencia</em>. En el primer caso, la elección de dichas funciones es menos restrictiva ya que lo que se trata es de ajustar un modelo que permita predecir confiablemente los valores de la variable respuesta. Mientras, en el segundo caso, las funciones propuestas no pueden ser cualesquiera sino que deben responder a una característica del fenómeno bajo estudio.</p>
<p>Un modelo se construye a partir de <em>n</em> observaciones del tipo <span class="math"><script type="math/tex">(\boldsymbol{x}_i, Y_i)</script></span> con <span class="math"><script type="math/tex">i=1,...,n</script></span>. Es por ello que se lo suele formular en términos matriciales:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{Y}= \begin{bmatrix}  Y_1 \\...\\Y_i \\ ... \\ Y_n\end{bmatrix}=\begin{bmatrix} q_0(\boldsymbol{x}_1) & ...& q_j(\boldsymbol{x}_1) & ... & q_{p-1}(\boldsymbol{x}_1) \\ ... & ... & ... & ... & ...\\ q_0(\boldsymbol{x}_i) & ...& q_j(\boldsymbol{x}_i) & ... & q_{p-1}(\boldsymbol{x}_i) \\ ... & ... & ... & ... & ... \\
q_0(\boldsymbol{x}_n) & ...& q_j(\boldsymbol{x}_n) & ... & q_{p-1}(\boldsymbol{x}_n) \end{bmatrix} \begin{bmatrix} \beta_0 \\ ... \\ \beta_j \\ ... \\ \beta_{p-1} \end{bmatrix}+\begin{bmatrix} \epsilon_0 \\ ... \\ \epsilon_j \\ ... \\ \epsilon_{p-1} \end{bmatrix}=\boldsymbol{X}\boldsymbol{\beta}+\boldsymbol{\epsilon}</script></span></p>
</center>
<p>En esta expresión, <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> es el <em>vector de parámetros</em> cuyos valores son desconocidos, <span class="math"><script type="math/tex">\boldsymbol{\epsilon}</script></span> es el vector de error, con distribución <span class="math"><script type="math/tex">N(0,\boldsymbol{\Sigma})</script></span> y <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> es la <strong>matriz de diseño</strong>. Luego,</p>
<center>
<p><span class="math"><script type="math/tex">E(\boldsymbol{Y}|\boldsymbol{x})=E(\boldsymbol{X}\boldsymbol{\beta}+\boldsymbol{\epsilon})=E(\boldsymbol{X}\boldsymbol{\beta})+E(\boldsymbol{\epsilon})=\boldsymbol{X}\boldsymbol{\beta}</script></span></p>
<p><span class="math"><script type="math/tex">V(\boldsymbol{Y})=V(\boldsymbol{X}\boldsymbol{\beta}+\boldsymbol{\epsilon})=V(\boldsymbol{\epsilon})=\boldsymbol{\Sigma}</script></span></p>
</center>
<p>Es decir, <span class="math"><script type="math/tex">\boldsymbol{Y}|\boldsymbol{x}\sim N(\boldsymbol{\mu}, \boldsymbol{\Sigma})</script></span>. <span class="math"><script type="math/tex">\boldsymbol{\mu}</script></span> tiene <span class="math"><script type="math/tex">n</script></span> elementos y <span class="math"><script type="math/tex">\boldsymbol{\Sigma}</script></span>, <span class="math"><script type="math/tex">n(n-1)/2</script></span>, mientras que <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> tiene <span class="math"><script type="math/tex">p</script></span> elementos. Generalmente, el número de observaciones disponibles es menor que el total de parámetros que deben estimarse, por lo que se suelen fijar los valores de ciertos parámetros a la hora de definir el modelo.</p>
<h3>Modelos lineales clásicos</h3>
<p>En el caso de los <em>modelos lineales</em> clásicos, que son los que estudiaremos en este capítulo, se asume que <span class="math"><script type="math/tex">\boldsymbol{\mu}=\boldsymbol{X}\boldsymbol{\beta}</script></span> y que <span class="math"><script type="math/tex">\boldsymbol{\Sigma}=\sigma^2\boldsymbol{I}_n</script></span> siendo <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> un vector de parámetros de <em>efectos fijos</em> con <span class="math"><script type="math/tex">p</script></span> elementos. Particularmente, la ecuación <span class="math"><script type="math/tex">E(\boldsymbol{Y}|\boldsymbol{x})=\boldsymbol{X\beta}</script></span> es la <em>ecuación del modelo</em>, el cual por asumir varianza constante, se dice <em>homocedástico</em>. Además, como <span class="math"><script type="math/tex">\boldsymbol{\Sigma}</script></span> resulta simétrica ya que los pares <span class="math"><script type="math/tex">(\epsilon_i, \epsilon_j),~i=1,...,n</script></span> y <span class="math"><script type="math/tex">j=1,...,n</script></span> con <span class="math"><script type="math/tex">i\neq j</script></span> son no correlacionados (independientes). La <em>matriz de diseño</em> o <em>matriz del modelo</em>, <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> puede contener todos elementos 0 o 1, caso en el que recibe el nombre de <em>matriz de incidencia</em> o puede también contener valores numéricos reales.
En el primer caso, la matriz se corresponde con un experimento en donde se analiza el <em>efecto</em> de los distintos <em>niveles</em> de diversos <em>factores experimentales</em>.</p>
<p>Por ejemplo, supongamos un estudio donde se ha determinado el número glóbulos rojos en un conjunto de pacientes, algunos de ellos que han recibido una dieta reforzada en Hierro, otros han combinado su dieta normal con intermitencias de suplementos de hierro y otros han continuado con su alimentación normal. En este experimento, la <em>variable respuesta</em> es el número de glóbulos rojos, mientras que la <em>variable predictora</em> es la <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">dieta</code>. La variable predictora, en este caso también se denomina <em>variable de clasificación</em> o <em>factor</em> ya que permite categorizar a los individuos bajo estudio en distintos grupos, según sus distintos <em>niveles</em>. En este caso, el factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">dieta</code> tiene tres niveles, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">reforzada</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">intermitente</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">normal</code>.</p>
<p>En el segundo caso, la matriz de diseño se corresponde con un experimento en donde al menos una de las <em>variables independientes</em> son del tipo continuas, comúnmente denominadas como <em>regresoras</em>. Suponga por ejemplo, que en el experimento anterior además de la dieta de cada paciente se ha registrado el peso de cada uno de ellos. Esta variable actía ahora como una <em>covariable</em> continua.</p>
<h3>Estimación de los parámetros del modelo</h3>
<p>El ajuste de un modelo lineal clásico consiste en estimar el valor del vector de parámetros <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> y de la matriz de varianzas y covarianzas <span class="math"><script type="math/tex">\boldsymbol{\Sigma}=\sigma^2\boldsymbol{I}_n</script></span>, es decir el valor de <span class="math"><script type="math/tex">\sigma^2</script></span>. Generalmente, los estimadores que se utilizan son los obtenidos mediante el método de <em>mínimos cuadrados ordinarios</em> (<em>ordinary least square, OLS</em>) o el método de <em>máxima verosimilitud</em> (<em>maximum likelihood, ML</em>).</p>
<h4>Estimadores OLS</h4>
<p>La estimación mediante el método <em>OLS</em> tiene como objetivo minimizar el error que comete el modelo al realizar las estimaciones. Para ello, busca los valores de los parámetros del modelo que minimicen la <em>suma de cuadrados del error o residual</em>:</p>
<center>
<p><span class="math"><script type="math/tex">RSS=\sum\limits_{i=1}^n e_i^2=\sum\limits_{i=1}^n(y_i-\hat{y_i})^2</script></span></p>
</center>
<p>o en forma matricial</p>
<center>
<p><span class="math"><script type="math/tex">RSS=\sum\limits_{i=1}^n e^2_i=\boldsymbol{e}^T\boldsymbol{e}=(\boldsymbol{y}-\boldsymbol{X\beta})^T(\boldsymbol{y}-\boldsymbol{X\beta})</script></span></p>
</center>
<p>Donde <span class="math"><script type="math/tex">\boldsymbol{e}</script></span> son los <em>residuos</em> del modelo.</p>
<p>Al derivar esta ecuación respecto a <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> e igualarla a 0 se obtiene que el valor buscado, <span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}</script></span> satisface:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{X}^T\boldsymbol{X}\boldsymbol{\beta}=\boldsymbol{X}^T\boldsymbol{y}</script></span></p>
</center>
<p>Que es lo que se conoce como <em>ecuaciones normales</em>. La solución de este sistema existe siempre y cuando <span class="math"><script type="math/tex">\boldsymbol{X}^T\boldsymbol{X}</script></span> es de rango completo. El estimador del vector de parámetros será</p>
<center>
<p><span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}=(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{y}</script></span></p>
</center>
<p>Adicionalmente, de estas ecuaciones se desprende que:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{\boldsymbol{y}}=\boldsymbol{X}\boldsymbol{\beta}=\boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{Y}=\hat{\boldsymbol{H}}\boldsymbol{y}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">\hat{\boldsymbol{H}}</script></span> es la <em>matriz hat</em>, que no es más que la matriz de proyección ortogonal de <span class="math"><script type="math/tex">\boldsymbol{y}</script></span> sobre el espacio generado por las columnas de <span class="math"><script type="math/tex">\boldsymbol{X}</script></span>.</p>
<p>Además, <span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}</script></span> es un estimador <em>insesgado</em> para <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> ya que:</p>
<center>
<p><span class="math"><script type="math/tex">E(\hat{\boldsymbol{\beta}})=E((\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T(\boldsymbol{X\beta}+\boldsymbol{\epsilon}))=E(\boldsymbol{\beta})+E((\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{\epsilon})=\boldsymbol{\beta}</script></span></p>
</center>
<p>y tiene varianza dada por:</p>
<center>
<p><span class="math"><script type="math/tex">Var(\hat{\beta})=E((\hat{\beta}-\beta)(\hat{\beta}-\beta)^T)=E((\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{\epsilon}\boldsymbol{\epsilon}^T\boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1})=\sigma^2(\boldsymbol{X}^T\boldsymbol{X})^{-1}</script></span></p>
</center>
<p>Además, el estimador de <span class="math"><script type="math/tex">\sigma^2</script></span>, <span class="math"><script type="math/tex">\hat{\sigma}^2</script></span>, es:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{\sigma}^2=\frac{\boldsymbol{e}^T\boldsymbol{e}}{n-p}=\frac{RSS}{n-p}</script></span></p>
</center>
<p>Cabe destacar que <span class="math"><script type="math/tex">\hat{\sigma}^2</script></span> es un estimador <em>insesgado</em> para <span class="math"><script type="math/tex">\sigma^2</script></span>, <span class="math"><script type="math/tex">p</script></span> es el rango de la matriz <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> y <span class="math"><script type="math/tex">n-p</script></span> son los <em>grados de libertad</em> del modelo.</p>
<p>Finalmente, el <em>error estandar</em> de <span class="math"><script type="math/tex">\beta_{i-1}</script></span> está dado por <span class="math"><script type="math/tex">EE_{i-1}=\sqrt{(\boldsymbol{X}^T\boldsymbol{X}_{ii})^{-1}\hat\sigma^2}</script></span>.</p>
<h4>Estimadores de máxima verosimilitud</h4>
<p>Los estimadores ML se basan en maximizar la función de verosimilitud del vector de variables respuestas <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span>. Como se especifico anteriormente, este vector se asume con distribución normal multivariada, <span class="math"><script type="math/tex">\boldsymbol{Y}|\boldsymbol{x}\sim N(\boldsymbol{\mu},\sigma^2\boldsymbol{I}_n)</script></span>. La función de verosimilitud para dicha distribución es:</p>
<center>
<p><span class="math"><script type="math/tex">L(\boldsymbol{\beta}, \sigma^2:\boldsymbol{y}|\boldsymbol{x})=(2\pi)^{-\frac{n}{2}}(\sigma^2)^{-\frac{n}{2}}e^{-\frac{1}{2\sigma^2}[(\boldsymbol{y}-\boldsymbol{X\beta})^T(\boldsymbol{y}-\boldsymbol{X\beta})]}</script></span></p>
</center>
<p>Como los valores de la variable respuesta se consideran fijos, el objetivo es encontrar el valor de <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> y <span class="math"><script type="math/tex">\sigma^2</script></span> que maximice la función de verosimilitud <span class="math"><script type="math/tex">(L(\boldsymbol{\beta}, \sigma^2:\boldsymbol{y}|\boldsymbol{x}))</script></span>. Trabajar con esta expresión en búsqueda de una maximización no es sencillo, por ello se busca utilizar una función monótona creciente de dicha función. Para ello, se considera la función logaritmo natura de <span class="math"><script type="math/tex">L</script></span> <span class="math"><script type="math/tex">(ln(L(\boldsymbol{\beta}, \sigma^2:\boldsymbol{y}|\boldsymbol{x})))</script></span> conocida como función  <em>log-verosimilitud</em>.</p>
<p>La búsqueda del máximo de <span class="math"><script type="math/tex">ln(L)</script></span> se realiza mediante el método de las derivadas primeras. Se determina la derivada de la función respecto a cada uno de los parámetros y luego se iguala las expresiones obtenidas a 0. De esta manera se resuelve el sistema para encontrar los valores de <span class="math"><script type="math/tex">\boldsymbol{\beta}</script></span> y <span class="math"><script type="math/tex">\sigma^2</script></span> que maximizan la función en simultáneo.</p>
<p>Al realizar este procedimiento se llega al mismo conjunto de ecuaciones normales para el método OLS, por lo que, por un lado</p>
<center>
<p><span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}=(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{y}</script></span></p>
</center>
<p>nuevamente, resultando <span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}</script></span> un estimador <em>insesgado</em> para el vector de parámetros. Mientras, el estimador para <span class="math"><script type="math/tex">\sigma^2</script></span> está dado por:</p>
<center>
<p><span class="math"><script type="math/tex">\tilde{\sigma}^2=\frac{\boldsymbol{e}^T\boldsymbol{e}}{n}=\frac{RSS}{n}</script></span></p>
</center>
<p>Cabe destacar que, en este caso, el estimador <span class="math"><script type="math/tex">\tilde{\sigma}^2</script></span> es <em>sesgado</em>, por lo que se suele utilizar una corrección sobre el para obtener un estimador <em>insesgado</em>:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{\sigma}^2=\tilde{\sigma}^2\frac{n}{n-p}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">\hat{\sigma}^2</script></span> no es más que el estimador de <span class="math"><script type="math/tex">\sigma^2</script></span> obtenido por el método OLS.</p>
<h3>Implicancias del modelo lineal general</h3>
<p>A continuación vamos a analizar algunas implicancias del modelo lineal y los métodos de estimación de los parámetros, útiles a la hora de evaluar el ajuste de un modelo.</p>
<p>Recordemos, tanto el estimador MV como el OLS para el vector de parámetros resultó ser:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{\hat{\beta}}=(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T\boldsymbol{y}</script></span></p>
</center>
<p>Por lo tanto,</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{X}^T\boldsymbol{X}\boldsymbol{\hat{\beta}}=\boldsymbol{X}^T\boldsymbol{y}</script></span></p>
<p><span class="math"><script type="math/tex">\boldsymbol{X}^T\boldsymbol{X}\boldsymbol{\hat{\beta}}=\boldsymbol{X}^T(\boldsymbol{X}\hat{\boldsymbol{\beta}}+\boldsymbol{\epsilon})</script></span></p>
</center>
<p>Luego,</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{X}^T\boldsymbol{\epsilon}=\boldsymbol{0}</script></span></p>
</center>
<p>Lo cual implica que:</p>
<ol>
<li>Los valores observados de <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> <strong>NO</strong> están correlacionados con los residuos del modelo.</li>
</ol>
<p>Si nuestro modelo incluye un término constante, entonces la primer columna de la matriz <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> se compone de todos 1 y se verifica que,</p>
<ol start="2">
<li>La suma de los residuos es <span class="math"><script type="math/tex">0</script></span>.</li>
<li>La media muestral de los residuos, <span class="math"><script type="math/tex">\boldsymbol{\overline{e}}=\frac{\sum\limits_{i=1}^ne_i}{n}=0</script></span></li>
<li>Los <em>valores predichos</em> de la variable respuesta <strong>NO</strong> están correlacionados con los residuos del modelo</li>
</ol>
<p>Cabe destacar además que <span class="math"><script type="math/tex">\boldsymbol{e}\sim N(\boldsymbol{0}, \hat\sigma^2(\boldsymbol{I}_n-\boldsymbol{H}))</script></span> ya que:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{e}=\boldsymbol{y}-\boldsymbol{\hat{y}}=\boldsymbol{y}-\boldsymbol{X\hat{\beta}}=(\boldsymbol{I}_n-\boldsymbol{H})\boldsymbol{y}</script></span></p>
<p><span class="math"><script type="math/tex">E(\boldsymbol{e})=E(\boldsymbol{y}-\boldsymbol{\hat{y}})=0</script></span></p>
<p><span class="math"><script type="math/tex">Var(\boldsymbol{e})=Var((\boldsymbol{I}_n-\boldsymbol{H})\boldsymbol{y})=\hat{\sigma}^2(\boldsymbol{I}_n-\boldsymbol{H})</script></span></p>
</center>
<p>Además, se define el <em>residuo estandarizado</em> a</p>
<center>
<p><span class="math"><script type="math/tex">r_i=\frac{e_i}{\sqrt{\hat{\sigma}^2(1-h_{ii})}}</script></span></p>
</center>
<h3>Pruebas de hipótesis</h3>
<p>Muchas veces será necesario realizar diferentes pruebas de hipótesis para, por ejemplo, decidir si un modelo es mejor que otro o para identificar aquellos coeficientes que no tienen efecto en la variable respuesta.</p>
<h4>Pruebas de hipótesis sobre los coeficientes</h4>
<p>El caso más sencillo a probar es si el coeficiente <span class="math"><script type="math/tex">\beta_{i}</script></span> es nulo, lo que implicaría que no hay relación lineal entre <span class="math"><script type="math/tex">\boldsymbol{Y}</script></span> y la variable <span class="math"><script type="math/tex">\boldsymbol{x}_{i+1}</script></span>, es decir formular el test de hipótesis:</p>
<center>
<p><span class="math"><script type="math/tex">H_0:~\beta_{i}=0</script></span></p>
<p><span class="math"><script type="math/tex">H_1:~\beta_{i} \neq 0</script></span></p>
</center>
<p>cuyo estadístico de prueba es</p>
<center>
<p><span class="math"><script type="math/tex">t_{i}=\frac{\hat{\beta_{i}}}{EE(\hat{\beta_{i}})}</script></span>, con <span class="math"><script type="math/tex">t_i \sim t_{n-p}</script></span></p>
</center>
<p>Si quisiera por ejemplo evaluar si <span class="math"><script type="math/tex">\beta_i=b</script></span> entonces simplemente se plantea el test <span class="math"><script type="math/tex">H_0:~\beta_i=b~vs~H_1:~\beta_i\neq b</script></span> cuyo estadístico es:</p>
<center>
<p><span class="math"><script type="math/tex">t_{i}=\frac{\hat{\beta_{i}}-b}{EE(\hat{\beta_{i}})}</script></span>, con <span class="math"><script type="math/tex">t_i \sim t_{n-p}</script></span></p>
</center>
<p>En forma general, es posible plantear una prueba de hipótesis para <em>contrastes</em> más complejos de la forma <span class="math"><script type="math/tex">\boldsymbol{H\beta}=\boldsymbol{h}</script></span>, donde <span class="math"><script type="math/tex">\boldsymbol{H}</script></span> es una matriz <span class="math"><script type="math/tex">q</script></span>x<span class="math"><script type="math/tex">p</script></span> donde <span class="math"><script type="math/tex">q</script></span> es el rango de <span class="math"><script type="math/tex">\boldsymbol{H}</script></span> y representa un número de coeficientes fijos especificados para el test. En el ejemplo anterior, el test se plantearía utilizando <span class="math"><script type="math/tex">\boldsymbol{H}=[0,...,1,...,0]</script></span> y <span class="math"><script type="math/tex">\boldsymbol{h}=[b]</script></span>. Otro ejemplo puede ser aquel que plantea que todos los parámetros del modelo son nulos a la vez, es decir:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{H}_{(p-1)xp}=\begin{bmatrix} 1 & 0 & 0 & ... & 0 \\ 0 & 1 & 0 & ... & 0 \\ 0 & 0 & 1 & ... & 0 \\ ... & ... & ... & ... & ...\\ 0 & 0 & 0 & ... & 1 \end{bmatrix}</script></span> y <span class="math"><script type="math/tex">\boldsymbol{h}_{p-1}=\begin{bmatrix} 0 \\0 \\0\\...\\ 0\end{bmatrix}</script></span></p>
</center>
<p>Ahora bien, cómo determinamos el estadístico de prueba para evaluar esta hipótesis nula? Esto lo hacemos con la <em>prueba del cociente de verosimilitudes</em> conocido por su nombre en inglés, <em>likelihood ratio test</em> (LRT). La prueba consiste en evaluar el cambio en la función de verosimilitud al asumir cierta la hipótesis nula. Para ello se define el <em>cociente de verosimilitudes</em>:</p>
<center>
<p><span class="math"><script type="math/tex">V=L(h)/L(M)</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">L(h)</script></span> refiere a la función de verosimilitud bajo hipótesis nula cierta, es decir cuando se cumple que <span class="math"><script type="math/tex">\boldsymbol{H\beta}=\boldsymbol{h}</script></span> y <span class="math"><script type="math/tex">L(M)</script></span>, al valor máximo de la función de verosimilitud, es decir, cuando los parámetros valen <span class="math"><script type="math/tex">\hat{\boldsymbol{\beta}}_{MV}</script></span> y <span class="math"><script type="math/tex">\hat{\sigma}^2_{MV}</script></span>. Siempre se cumplirá que <span class="math"><script type="math/tex">L(h)\leq L(M)</script></span>, de manera que <span class="math"><script type="math/tex">V \to 1</script></span> mientras <span class="math"><script type="math/tex">L(h) \to L(M)</script></span>, caso en que no debería rechazarse la hipótesis nula. De lo contrario si <span class="math"><script type="math/tex">L(h)</script></span> se aleja de <span class="math"><script type="math/tex">L(M)</script></span> el cociente se alejará de 1, lo que indica que hay evidencias suficientes para rechazar la hipótesis nula, por ser significativo el cambio en la función de verosimilitud. Como la función de log-verosimilitud sigue el mismo comportamiento que <span class="math"><script type="math/tex">L</script></span>, suele utilizarse ésta</p>
<p>En el contexto de los modelos lineales generales, la forma de <span class="math"><script type="math/tex">V</script></span> es:</p>
<center>
<p><span class="math"><script type="math/tex">V=(\frac{\hat{\sigma}_h^2}{\hat{\sigma}})^{-\frac{n}{2}}</script></span></p>
</center>
<p>Este estadístico no tiene distribución conocida, pero a partir de el se construye el estadístico <span class="math"><script type="math/tex">w</script></span> de la prueba, el cual si tiene distribución conocida:</p>
<center>
<p><span class="math"><script type="math/tex">W=(V^{-\frac{2}{n}}-1)(\frac{n-p}{q})=(\frac{n-p}{q})\frac{(\boldsymbol{H\hat{\beta}}-\boldsymbol{h})^T(\boldsymbol{H}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{H}^T)^{-1}(\boldsymbol{H\hat{\beta}}-\boldsymbol{h})}{\boldsymbol{y}^T(\boldsymbol{I}-\boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T)\boldsymbol{y}}</script></span></p>
</center>
<p>Como <span class="math"><script type="math/tex">W</script></span> es el cociente de dos variables <span class="math"><script type="math/tex">\chi^2</script></span>, <span class="math"><script type="math/tex">W</script></span> tiene distribución <span class="math"><script type="math/tex">F_{q,n-p,\lambda}</script></span> con <span class="math"><script type="math/tex">\lambda</script></span> parametro de no centralidad cuyo valor bajo hipótesis nula es 0.</p>
<p>Las pruebas de hipótesis también se suelen construir mediante la utilización de las <em>sumas de cuadrados</em>. Para ello se descompone la <em>suma de cuadrados totales (TSS)</em>, <span class="math"><script type="math/tex">(\boldsymbol{y}-\overline{\boldsymbol{y}})^T(\boldsymbol{y}-\overline{\boldsymbol{y}})</script></span>, en la:</p>
<ul>
<li><em>suma de cuadrados del modelo (RMS)</em>, <span class="math"><script type="math/tex">(\boldsymbol{y}-\overline{\boldsymbol{y}})^T( \boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T)(\boldsymbol{y}-\overline{\boldsymbol{y}})</script></span></li>
<li><em>suma de cuadrados residual (RSS)</em>, <span class="math"><script type="math/tex">\boldsymbol{y}^T( \boldsymbol{I}-\boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T)\boldsymbol{y}</script></span></li>
</ul>
<p>De manera entonces que el estadístico del test es:</p>
<center>
<p><span class="math"><script type="math/tex">W=\frac{n-p}{q}\frac{RMS}{RSS}</script></span></p>
</center>
<p>el cual tiene distribución <span class="math"><script type="math/tex">F_{q,n-p,\lambda}</script></span>, con <span class="math"><script type="math/tex">\lambda=0</script></span> bajo <span class="math"><script type="math/tex">H_0</script></span>.</p>
<p>Es posible también analizar las sumas de cuadrados parciales asociadas a algunos de los coeficientes del modelo. Para ello, se debe considerar las submatrices de <span class="math"><script type="math/tex">\boldsymbol{X}</script></span> correspondientes a tales coeficientes a la hora de determinar las sumas de cuadrados. Este análisis es muy común ya permite descomponer la varianza total de los datos según el porcentaje de ésta que explica cada una de las variables del modelo, para así poder distinguir cuales de las variables aportan al poder explicativo y cuales no. Comúnmente, en el contexto de los modelos de clasificación se conoce este análisis como <em>ANOVA</em> o <em>Análisis de la Varianza</em>.</p>
<h2>Modelos de regresión lineal</h2>
<p>Los <em>modelos de regresión</em> se utilizan para explicar o modelar la relación entre una variable respuesta <span class="math"><script type="math/tex">Y</script></span> y un conjunto de variables <em>explicativas</em>, <em>predictoras</em> o <em>regresoras</em>, <span class="math"><script type="math/tex">x_1</script></span>, <span class="math"><script type="math/tex">x_2</script></span>, …, <span class="math"><script type="math/tex">x_n</script></span>, donde al menos una de ellas es del tipo continua. El caso en el que <span class="math"><script type="math/tex">n=1</script></span>, el modelo se llama de <em>regresión simple</em> mientras que si <span class="math"><script type="math/tex">n>1</script></span> el modelo se llama de <em>regresión múltiple</em>.</p>
<h3>Base de datos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">prostate</code></h3>
<p>A lo largo de esta unidad vamos a trabajar sobre un conjunto de datos del paquete <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code> <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">faraway</code>, conteniendo los datos de ejemplo del libro <em>Linear Models with R, Julian J Faraway, Chapman &amp; Hall, 2009</em>. Para poder utilizarlo, primero instalaremos el paquete:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; install.packages("faraway")</span></span></span>
</pre>
<p>El conjunto de datos se llama <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">prostate</code> y contiene los registros de pacientes con cáncer de próstata sometidos a una prostatectomía radical.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; data(prostate, package="faraway")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; head(prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span>        </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol  lweight age   lbph   svi    lcp     gleason pgg45   lpsa</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>1 -0.5798185  2.7695  50 -1.386294   0 -1.38629       6     0 -0.43078</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  2 -0.9942523  3.3196  58 -1.386294   0 -1.38629       6     0 -0.16252</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  3 -0.5108256  2.6912  74 -1.386294   0 -1.38629       7    20 -0.16252</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  4 -1.2039728  3.2828  58 -1.386294   0 -1.38629       6     0 -0.16252</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  5  0.7514161  3.4324  62 -1.386294   0 -1.38629       6     0  0.37156</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  6 -1.0498221  3.2288  50 -1.386294   0 -1.38629       6     0  0.76547</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span>     </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol           lweight           age             lbph              svi        </span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min.   :-1.3471   Min.   :2.375   Min.   :41.00   Min.   :-1.3863   Min.   :0.0000  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 1st Qu.: 0.5128   1st Qu.:3.376   1st Qu.:60.00   1st Qu.:-1.3863   1st Qu.:0.0000  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Median : 1.4469   Median :3.623   Median :65.00   Median : 0.3001   Median :0.0000  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Mean   : 1.3500   Mean   :3.653   Mean   :63.87   Mean   : 0.1004   Mean   :0.2165  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 3rd Qu.: 2.1270   3rd Qu.:3.878   3rd Qu.:68.00   3rd Qu.: 1.5581   3rd Qu.:0.0000  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Max.   : 3.8210   Max.   :6.108   Max.   :79.00   Max.   : 2.3263   Max.   :1.0000  </span></span></span>
<span class="syntax--text syntax--plain"><span>      </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcp             gleason          pgg45             lpsa        </span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min.   :-1.3863   Min.   :6.000   Min.   :  0.00   Min.   :-0.4308  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 1st Qu.:-1.3863   1st Qu.:6.000   1st Qu.:  0.00   1st Qu.: 1.7317  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Median :-0.7985   Median :7.000   Median : 15.00   Median : 2.5915  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Mean   :-0.1794   Mean   :6.753   Mean   : 24.38   Mean   : 2.4784  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 3rd Qu.: 1.1786   3rd Qu.:7.000   3rd Qu.: 40.00   3rd Qu.: 3.0564  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Max.   : 2.9042   Max.   :9.000   Max.   :100.00   Max.   : 5.5829  </span></span></span>
</pre>
<p>La base de datos se compone de registros obtenidos en biopsias de prostata de 97 pacientes. Particularmente, las nueve variables registradas son:</p>
<ul>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code>: logarítmo del volúmen tumoral (cc)</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lweight</code>: logarítmo del peso de la próstata (g)</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">age</code>: edad del paciente (año)</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lbph</code>: logarítmo de la cantidad de hiperplasia prostática benigna (<span class="math"><script type="math/tex">cm^2</script></span>)</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code>: presencia (1) o ausencia (0) de invasión de la vesícula seminal</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcp</code>: logarítmo del grado de penetración del tumor en la cápsula de la próstata (cm)</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">gleason</code>: Escore de <em>Gleason</em></li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">pgg45</code>: porcentaje del Escore de <em>Gleason</em>, indicador patólógico.</li>
<li><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>: logarítmo de la concentración de antígeno prostático específico (mg/ml)</li>
</ul>
<p>El interés de este estudio se centra en la concentración de antígeno prostático específico (<em>prostatic specific antygen</em>, PSA), indicador útil para el diagnóstico y durante el tratamiento del cáncer de próstata ya que en estos casos se encuentra en valor aumentado respecto de los pacientes sanos. El objetivo es explicar la relación entre la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> y las covariables.</p>
<p><strong>Ejercicio</strong>: Realice un análisis exploratorio de la base de datos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">prostate</code>. Redefina las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Gleason</code> como factores. Complemente el análisis con resultados gráficos y analíticos.</p>
<h3>Regresión lineal simple</h3>
<p>Un modelo sencillo para comenzar a explorar la relación entre las variables de interés es el <em>modelo de regresión simple</em>. La ecuación del modelo de regresión lineal simple es:</p>
<center>
<p><span class="math"><script type="math/tex">Y_i = \beta_0 + \beta_1x_i + \epsilon_i</script></span></p>
</center>
<p>donde, <span class="math"><script type="math/tex">\beta_0</script></span> se conoce como <em>intercepto</em> y <span class="math"><script type="math/tex">\beta_1</script></span> es la <em>pendiente</em>. Estos dos coeficientes se denominan <em>coeficientes de regresión</em>, mientras que <span class="math"><script type="math/tex">\epsilon_i</script></span> es el término de error asociado a la i-ésima observación y representa la diferencia que existe entre el valor observado de <em>Y_i</em> y su valor esperado</p>
<center>
<p><span class="math"><script type="math/tex">\epsilon_i=Y_i - (\beta_0 + \beta_1x_i)=Y_i-E(Y_i|X_i=x_i)</script></span></p>
</center>
<p>recordemos además que <span class="math"><script type="math/tex">\epsilon_i~\sim~N(0,\sigma^2)</script></span> es decir, siendo <span class="math"><script type="math/tex">\epsilon_i,~i=1,...,n</script></span> VAs <em>iid</em>.</p>
<p>Para comprender el concepto estadístico detrás del modelo de regresión lineal simple, observemos la <a href="#Figura1">Figura 1</a>.</p>
<p><img src="../Imagenes/regression1.png" alt="Figura1"> <em><strong>Figura 1</strong></em>: <em>Modelo de regresión lineal simple. Extraído de Introductory Statistics (Shafer and Zhang), UC Davis Stat Wikn.</em></p>
<p>Este modelo tiene tres parámetros a estimar, los cuales son fijos pero desconocidos: <span class="math"><script type="math/tex">\beta_0</script></span>, <span class="math"><script type="math/tex">\beta_1</script></span> y <span class="math"><script type="math/tex">\sigma^2</script></span>.</p>
<p>En el caso de nuestro conjunto de datos <em>prostate</em> la variable respuesta es la concentración de antígeno prostático. En este caso, esta variable se encuentra en escala logarítmica (<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>).  ¿Qué piensa de esto?</p>
<h4>Construcción del modelo</h4>
<p>Veamos que sucede con la distribución de la variable respuesta en su escala natural y en la escala logarítmica.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; df&lt;-data.frame(psa=exp(prostate$lpsa), lpsa=prostate$lpsa)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g1&lt;-ggplot(df, aes(x=1, y=psa))+geom_violin(fill="blue", color="blue", alpha=0.2,</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>draw_quantiles =  c(0.25, 0.5, 0.75))+labs(x="")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g2&lt;-ggplot(df, aes(x=1, y=lpsa))+geom_violin(fill="red", color="red", alpha=0.2,</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>draw_quantiles  = c(0.25, 0.5, 0.75))+labs(x="")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p&lt;-plot_grid(g1,g2, labels=c("A", "B"),nrow=1)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p</span></span></span>
</pre>
<p><img src="../Imagenes/boxplotsLSA.png" alt="Figura2"> <em><strong>Figura 2</strong></em>: <em>Diagramas de violín de la variable concentración de antígeno prostático específico (psa) en su escala natural (<strong>A</strong>) y en escala logarítmica (<strong>B</strong>).</em></p>
<p>Según los diagramas, la distribución de la variable <em>psa</em> en escala logarítmica (<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>) aparenta ser simétrica y unimodal, como lo es la distribución normal, requisito fundamental para considerar esta variable como respuesta de un modelo lineal. Existen diversas pruebas, gráficas y analíticas, para soportar este comportamiento, las cuales profundizaremos más adelante.</p>
<p>Buscamos construir un modelo de regresión simple que explique la concentración de psa en los pacientes. Para seleccionar que variable utilizaremos como regresora, podemos estudiar la correlación entre las distintas columnas del <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">data.frame</code> <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">prostate</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; cor(prostate[,-c(5,7)])</span></span></span>
<span class="syntax--text syntax--plain"><span>             </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol   lweight       age        lbph         lcp     pgg45      lpsa</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol  1.00000000 0.1941284 0.2249999  0.02734971  0.67531058 0.4336522 0.7344603</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lweight 0.19412839 1.0000000 0.3075247  0.43493174  0.10023889 0.0508462 0.3541218</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  age     0.22499988 0.3075247 1.0000000  0.35018592  0.12766778 0.2761124 0.1695929</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lbph    0.02734971 0.4349317 0.3501859  1.00000000 -0.00699944 0.0784600 0.1798095</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lcp     0.67531058 0.1002389 0.1276678 -0.00699944  1.00000000 0.6315281 0.5488132</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  pgg45   0.43365224 0.0508462 0.2761124  0.07846000  0.63152807 1.0000000 0.4223157</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lpsa    0.73446028 0.3541218 0.1695929  0.17980950  0.54881316 0.4223157 1.0000000  </span></span></span>
</pre>
<p>Como se puede notar en la tabla de correlaciones, el valor más alto es para las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> y<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code>. Exploremos el diagrama de dispersión entre estas variables:</p>
<p><img src="../Imagenes/dispersionProstate.png" alt="Figura3"></p>
<p><em><strong>Figura 3</strong></em>: <em>Diagrama de dispersión entre las variables concentración de antígeno prostático específico y volumen tumoral, ambas en escala logarítmica.</em></p>
<p>Del gráfico es posible apreciar la relación lineal existente entre estas variables, por lo tanto usaremos a <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> como variable regresora.</p>
<h4>Ajuste e interpretación</h4>
<p>Para ajustar el modelo simplemente utilizaremos la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lm()</code> del paquete <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">stats</code> que se distribuye con la versión base de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code>. Para utilizarla debemos especificar la fórmula que representa la ecuación del modelo. La sintaxis para expresarla es relacionar la variable respuesta con la variable regresora mediante el operador <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">~</code>:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modelo&lt;-lm(lpsa~lcavol, data=prostate)</span></span></span>
</pre>
<p>Los resultados del ajuste del modelo pueden explorarse con diversas funciones. La más común es la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary()</code>, que resume el modelo ajustado:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lm(formula = lpsa ~ lcavol, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>      </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min       1Q   Median       3Q      Max</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.67625 -0.41648  0.09859  0.50709  1.89673</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)  1.50730    0.12194   12.36   &lt;2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  lcavol       0.71932    0.06819   10.55   &lt;2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  ---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7875 on 95 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  Multiple R-squared:  0.5394,	Adjusted R-squared:  0.5346</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  F-statistic: 111.3 on 1 and 95 DF,  p-value: &lt; 2.2e-16</span></span></span>
</pre>
<p>Analicemos ahora los resultados del ajuste del modelo. La información retornada por la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary()</code> se agrupa en cuatro bloques. Por un lado, el primer bloque muestra cómo se ha utilizado la función para ajustar el modelo. El segundo bloque de información resume los valores mínimo, máximo y los cuartiles Q1, Q2 y Q3 para los <em>residuos</em> del modelo. El tercer bloque especifica los detalles del ajuste de los parámetros del modelo y el cuarto refiere a los estadísticos útiles para evaluar la <em>bondad de ajuste</em>.</p>
<p>La información contenida en estos bloques puede ser obtenida a partir de los resultados del ajuste, almacenados en la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">modelo</code>. Por ejemplo, si queremos reproducir los resultados del segundo bloque informativo bastará con hacer:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modelo$residuals)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Min.  1st Qu.   Median     Mean  3rd Qu.     Max.</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.67625 -0.41648  0.09859  0.00000  0.50709  1.89673</span></span></span>
</pre>
<p>Los residuos del modelo también pueden obtenerse mediante la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">residuals()</code>. ¿Qué piensa acerca de los valores obtenidos para las medidas resumen estudiadas? Según las hipótesis del modelo lineal, los residuos deben tener distribución <span class="math"><script type="math/tex">N(0,\sigma^2\boldsymbol{I})</script></span>. Antes de entrar en el análisis diagnóstico del modelo ¿Piensa que esto se cumple?</p>
<p><strong>Ejercicio</strong>: Explore los otros elementos de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">modelo</code> a los cuales puede acceder mediante el operador <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">$</code>. Determine otra forma de obtener los residuos del modelo ajustado.</p>
<h5>Diagnóstico</h5>
<p>Al formular el modelo lineal general establecimos ciertas implicancias que se deben cumplir para que el modelo ajustado realmente pueda ser una representación del fenómeno real bajo estudio. Verificar que esto se cumpla es parte del análisis diagnóstico del modelo. Existen diversas estrategias para hacerlo, las más sencillas se basan en el uso de gráficos diagnósticos:</p>
<ul>
<li>QQplot de los residuos, dirigido a la comparación de los cuantiles de los residuos estandarizados con los de una distribución normal estándar.</li>
<li>Dispersión residuos vs predichos, para visualizar la independencia entre éstos.</li>
<li>Dispersión de residuos vs índice, para visualizar un posible patrón y/o correlación</li>
<li>Dispersión de residuos vs variables no incluídas en el modelo.</li>
<li>Dispersión de predichos vs variables incluídas/no incluídas en el modelo.</li>
</ul>
<p>Entre las técnicas analíticas, se destaca el <em>Test de Shapiro-Wilk</em>, útil para evaluar la normalidad de un conjunto de datos, en este caso, de los residuos del modelo. La hipótesis nula de la prueba es que los datos provienen de una distribución normal. Por lo tanto, un valor p menor que el umbral de significancia <span class="math"><script type="math/tex">\alpha</script></span> indica que hay evidencias suficientes para rechazar la hipótesis nula de normalidad, mientras que valores p más elevados indican que no se puede rechazar <span class="math"><script type="math/tex">H_0</script></span>. Justamente esto último es lo que buscamos en el contexto de la prueba de normalidad de los residuos del modelo lineal.</p>
<p>Comencemos por obtener el QQ-plot para los residuos. Lo que vamos a hacer primero es estandarizarlos:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; X&lt;-model.matrix(modelo) #Matriz del modelo</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS&lt;-sum(residuals(modelo)^2) # Suma de cuadrados residual</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; sigma2Hat&lt;-RSS/(modelo$df.residual) # Estimador de sigma^2</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; hatXX&lt;-X%*%solve(t(X)%*%X)%*%t(X) # Matriz Hat</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; estudRes&lt;-residuals(modelo)/sqrt(sigma2Hat*(1-diag(hatXX))))</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: Obtenga los residuos estandarizados utilizando la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">rstandard()</code>.</p>
<p>Ahora construimos el gráfico:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(data.frame(residuals=estudRes), aes(sample=residuals))+stat_qq(distribution = qnorm)+ stat_qq_line()</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; shapiro.test(residuals(modelo))</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span>	</span><span class="syntax--meta syntax--paragraph syntax--text"><span>Shapiro-Wilk normality test</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>data:  residuals(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>W = 0.97985, p-value = 0.1419</span></span></span>
</pre>
<p><img src="../Imagenes/qqplot.png" alt="Figura4"></p>
<p><em><strong>Figura 4</strong></em>: <em>QQ-plot para los residuos estandarizados del modelo de regresión simple.</em></p>
<p>Obtengamos ahora el diagrama de dispersión de los residuos y los valores predichos:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(data.frame(residuals=dfResiduals, predicted=fitted(modelo)), aes(x=predicted, y=residuals))+geom_point(color="blue")+labs(x="Valores predichos", y="Residuos estandarizados")</span></span></span>
</pre>
<p><img src="../Imagenes/resPred.png" alt="Figura5"></p>
<p><em><strong>Figura 5</strong></em>: <em>Diagrama de dispersión de los residuos estandarizados y los valores predichos por el modelo de regresión simple .</em></p>
<p><strong>Ejercicio</strong>: obtenga el resto de los gráficos, y concluya sobre si se cumplen o no las hipótesis del modelo lineal. ¿Qué debemos hacer si esto no sucede?</p>
<h5>Estimaciones</h5>
<p>Continuemos analizando el modelo ajustado. La reproducción de los resultados del tercer bloque de la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary()</code> es algo más laboriosa ya que implica calcular algunos de los valores. Comencemos por los valores estimados de los parámetros del modelo, los cuales podemos obtenerlos mediante la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">coefficients()</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; coeficientes&lt;-coefficients(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; coeficientes</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)      lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>1.5072979    0.7193201</span></span></span>
</pre>
<p>Según los resultados, nuestro modelo de regresión establece que</p>
<center>
<p><span class="math"><script type="math/tex">\hat{lpsa}_i=1.507+0.719lcavol_i</script></span></p>
</center>
<p>es decir, que la recta de regresión entre las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> tiene una ordenada al orígen (<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">Intercept</code>) que vale <span class="math"><script type="math/tex">1.5073</script></span> y una pendiente de <span class="math"><script type="math/tex">0.7193</script></span>. Este bloque nos dice además que el <em>error estándar</em> asociado al intercepto, <span class="math"><script type="math/tex">EE_0</script></span>, es <span class="math"><script type="math/tex">0.1219</script></span> y el asociado al coeficiente <em>lcavol</em>, <span class="math"><script type="math/tex">EE_1</script></span>, es <span class="math"><script type="math/tex">0.0682</script></span>.</p>
<p><strong>Ejercicio</strong>: Interprete los valores de los coeficientes en el contexto del problema y construya un invervalo de confianza para  <span class="math"><script type="math/tex">\hat{lcavol}</script></span>. Obtenga en <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code> los errores estándar asociados a los coeficientes del modelo.</p>
<p>Grafiquemos los datos y la recta de regresión:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(prostate, aes(x=lcavol, y=lpsa))+</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>geom_point(color="red")+geom_abline(intercept=1.057, slope=0.7193, color="blue")</span></span></span>
</pre>
<p><img src="../Imagenes/prostateReg.png" alt="Figura5"></p>
<p><em><strong>Figura 5</strong></em>: <em>Diagrama de dispersión entre las variables concentración de antígeno prostático específico y volumen tumoral, ambas en escala logarítmica y recta de regresión.</em></p>
<p>o utilizando la funcion <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">geom_smooth()</code>:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(prostate, aes(x=lcavol, y=lpsa))+</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>geom_point(color="red")+geom_smooth(method="lm")</span></span></span>
</pre>
<p><img src="../Imagenes/prostateReg2.png" alt="Figura6"></p>
<p><em><strong>Figura 6</strong></em>: <em>Diagrama de dispersión entre las variables concentración de antígeno prostático específico y volumen tumoral, ambas en escala logarítmica y recta de regresión.</em></p>
<p>Note que esta recta de regresión tiene asociada una <em>banda de confianza</em>, cuyos valores podemos obtener ejecutando <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">predict(modelo, interval="confidence")</code>.</p>
<p><strong>Ejercicio</strong>: Investigue el uso de la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">predict()</code> para predecir valores de la variable independiente. Encuentre el intervalo de confianza de la cantidad <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> para un valor de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code><span class="math"><script type="math/tex">=2</script></span>.</p>
<h5>Pruebas de hipótesis</h5>
<p>Otra información contenida en este mismo bloque es el valor del estadístico <span class="math"><script type="math/tex">t</script></span> y de la probabilidad asociada a éste para las pruebas de hipótesis sobre los coeficientes del tipo <span class="math"><script type="math/tex">H_0:~\hat{\beta}_i=0~vs~H_A:~\hat{\beta}_i \neq 0</script></span>. Se incluye además una especie de código que refiere a la significancia de dichas probabilidades respecto de diversos umbrales. En este ejemplo, para ambos coeficientes, el valor de probabilidad asociado al test es <span class="math"><script type="math/tex"><2 10^{-16}</script></span>, lo cual indica que hay evidencias suficientes en los datos para rechazar las <span class="math"><script type="math/tex">H_0</script></span>s correspondientes, por lo que el modelo debe contener el intercepto y la pendiente.</p>
<p>Para obtener estos valores podemos usar el siguiente fragmento de código:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; EEB&lt;-sqrt(diag(solve(t(X)%*%X))*sigma2Hat)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; tB&lt;-coeficientes/EEB</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; pB&lt;-2*pt(abs(tB), modelo$df.residual,lower.tail=FALSE)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; tB;pB</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)      lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span>   </span><span class="syntax--meta syntax--paragraph syntax--text"><span>12.36130       10.54832</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)      lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  1.722234e-21  1.118616e-17</span></span></span>
</pre>
<p>El cuarto bloque de información de la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary()</code> contiene el error estándar residual, RSS, anteriormente calculado y los grados de libertad (<span class="math"><script type="math/tex">n-p</script></span>). También contiene el valor de <span class="math"><script type="math/tex">R^2</script></span> también llamado <em>coeficiente de determinación</em> y su valor ajustado, <span class="math"><script type="math/tex">R^2_{adj}</script></span>. Este coeficiente es una de las medidas de <em>bondad de ajuste</em> más utilizadas en los modelos de regresión, ya que mide la proporción de la variabilidad observada que es explicada por el modelo ajustado:</p>
<center>
<p><span class="math"><script type="math/tex">R^2=1-\frac{RSS}{TSS_{corr}}=1-\frac{\sum\limits_{i=1}^n(\hat{y}_i-y_i)^2}{\sum\limits_{i=1}^n(\hat{y}_i-\overline{\boldsymbol{y}})^2}</script></span></p>
<p><span class="math"><script type="math/tex">R_{adj}=1-(1-R^2)\frac{n-1}{n-p}</script></span></p>
</center>
<p>Mientras más cercano a 1 esté, mejor será el ajuste del modelo a los datos, mientras que cuanto más se acerque dicho coeficiente a 0, menor será el ajuste. Dependiendo del área de aplicación y de las características del experimento (nivel de control sobre los datos, conocimiento del problema, etc) podrán aceptarse diferentes niveles de  <span class="math"><script type="math/tex">R^2</script></span></p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; Yobs&lt;-matrix(prostate$lpsa, ncol=1)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; TSS&lt;-t(Yobs-mean(Yobs))%*%(Yobs-mean(Yobs))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt;</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; R2&lt;-1-RSS/TSS</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; R2</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[,1]</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1,] 0.5394319</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; n&lt;-nrow(prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; R_adj&lt;-1-(1-R2)*(n-1)/(modelo$df.residual)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; R_adj</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[,1]</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1,] 0.5345838</span></span></span>
</pre>
<p><strong>Pregunta</strong>: Qué indica estos valores de <span class="math"><script type="math/tex">R^2</script></span>?</p>
<p>Finalmente, el último elemento del cuarto bloque devuelto por la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary()</code> son los resultados de la prueba de hipótesis del modelo. En el caso del modelo de regresión lineal simple, la prueba <em>t</em> de significancia sobre el coeficiente <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> es equivalente a la prueba <em>F</em> de significancia de la regresión. Particularmente, el estadístico de esta prueba <span class="math"><script type="math/tex">W</script></span> será igual al estadístico <span class="math"><script type="math/tex">t^2</script></span> y tendrá distribución <span class="math"><script type="math/tex">F_{1, n-p}</script></span>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; W&lt;-tB[2]^2</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; pW&lt;-1-pf(W, 1, modelo$df.residual)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; W;pW</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>111.267</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>0</span></span></span>
</pre>
<p>El estadístico <span class="math"><script type="math/tex">F</script></span> será igual al cociente entre el <em>cuadrado medio de la regresión</em> y el <em>cuadrado medio residual</em>. Ambos cuadrados medios, se obtienen al dividir la suma de cuadrados respectivas por los correspondientes grados de libertad.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RMS</span></span></span>
<span class="syntax--text syntax--plain"><span>         </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[,1]</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1,] 69.00283</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 58.91476</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS/95</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 0.6201553</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; (RMS/1)/(RSS/95)</span></span></span>
<span class="syntax--text syntax--plain"><span>        </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[,1]</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1,] 111.267</span></span></span>
</pre>
<p>Estos mismos resultados se pueden visualizar en la tabla de ANOVA:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Response: lpsa</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol     1 69.003  69.003  111.27 &lt; 2.2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Residuals 95 58.915   0.620                      </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> ---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<p>Hay una alternativa para obtener este resultado, la cual es útil además para comparar modelos anidados. En este caso estamos interesados en evaluar si el modelo que incorpora la variable regresora <span class="math"><script type="math/tex">y_i=\mu_0+lcavol_i+\epsilon_i</script></span> es más adecuado que el modelo que no la incorpora <span class="math"><script type="math/tex">y_i=\mu_0+\epsilon_i</script></span>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(lm(lpsa ~ 1, data = prostate), lm(lpsa~lcavol, data=prostate))</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: lpsa ~ 1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: lpsa ~ lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     96 127.918                                  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     95  58.915  1    69.003 111.27 &lt; 2.2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<h3>Regresión lineal múltiple</h3>
<h4>Generalidades</h4>
<p>El <em>modelo de regresión múltiple</em> admite la presencia de más de una regresora como variable predictiva. La ecuación general del modelo de regresión lineal múltiple es:</p>
<center>
<p><span class="math"><script type="math/tex">Y_i = \beta_0 + x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ip-1}\beta_{p-1}+ \epsilon_i</script></span></p>
</center>
<p>donde, <span class="math"><script type="math/tex">\beta_0</script></span> es el <em>intercepto</em> y <span class="math"><script type="math/tex">\beta_i</script></span> es el coeficiente de regresión asociado a la i-ésima regresora. Las variables regresoras podrán o no ser todas del tipo continuas. Cada uno de estos coeficientes representan el cambio en la variable respuesta debido a un cambio en una unidad de la variable regresora correspondiente, mientras el resto permanecen fijas. Recordemos además que <span class="math"><script type="math/tex">\epsilon_i</script></span> es el término de error, que se distribuye <span class="math"><script type="math/tex">\sim~N(0,\sigma^2)</script></span>,es decir <span class="math"><script type="math/tex">\epsilon_i,~i=1,...,n</script></span> VAs <em>iid</em>.</p>
<h4>Regresión lineal múltiple para lpsa</h4>
<p>Ajustemos un modelo de regresión lineal múltiple para <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>, considerando como regresoras las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lweight</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">age</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lbph</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcp</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">pgg45</code></p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; multipleReg&lt;-lm(lpsa~lcavol+lweight+age+lbph+lcp+pgg45, data=prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(multipleReg)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = lpsa ~ lcavol + lweight + age + lbph + lcp + pgg45,</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>     </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min       1Q   Median       3Q      Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.41989 -0.44616 -0.01308  0.40366  1.76377</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>             </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)  0.833707   0.868392   0.960  0.33960    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol       0.628344   0.089299   7.036 3.75e-10 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lweight      0.496270   0.175106   2.834  0.00567 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>age         -0.018302   0.011593  -1.579  0.11791    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lbph         0.078998   0.060145   1.313  0.19237    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcp          0.013881   0.086208   0.161  0.87244    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>pgg45        0.006034   0.003590   1.681  0.09625 .  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7386 on 90 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.6161,	Adjusted R-squared:  0.5905</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 24.08 on 6 and 90 DF,  p-value: &lt; 2.2e-16</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: Realice un análisis diagnóstico para evaluar si se cumplen las hipótesis del modelo.</p>
<p><strong>Ejercicio</strong>: Analice los valores de los coeficientes de regresión y los resultados de las correspondientes pruebas de hipótesis simples.</p>
<p>La ecuación del modelo de regresión múltiple es:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{lpsa}_i=0.834+0.628\hat{lcavol}_i+0.496\hat{lweight}-0.018\hat{age}_i+0.079\hat{lbph}_i+0.014\hat{lcp}_i+0.006\hat{pgg45}_i</script></span></p>
</center>
<p>En base a este modelo, podemos afirmar que un incremento de una unidad en la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code>, mientras el resto permanecen constantes, incrementará en 0.628 unidades a la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>. Similarmente, un incremento de una unidad en <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lweight</code> resultará en un aumento de 0.496 unidades de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lspa</code>, manteniendo las otras variables constantes. Los coeficientes asociados al resto de las variables regresoras son muy pequeños (<span class="math"><script type="math/tex"><0.08</script></span>), lo que implica que un cambio en dichas variables repercutirá muy poco en el valor de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>. Ajustemos un modelo entonces considerando como regresoras sólo a las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lweight</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code>:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; multipleRegSimpl&lt;-lm(lpsa~lcavol+lweight, data=prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(multipleRegSimpl)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = lpsa ~ lcavol + lweight, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>     </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min       1Q   Median       3Q      Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.61965 -0.50778 -0.02095  0.52291  1.89885</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept) -0.30262    0.56904  -0.532  0.59612    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol       0.67753    0.06626  10.225  &lt; 2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lweight      0.51095    0.15726   3.249  0.00161 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7506 on 94 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.5859,	Adjusted R-squared:  0.5771</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 66.51 on 2 and 94 DF,  p-value: &lt; 2.2e-16</span></span></span>
</pre>
<p>Nuevamente, las pruebas de hipótesis simples asociadas a los coeficientes de las regresoras han resultado en valores-p significativos. Lo mismo sucede con la prueba <em>F</em>, de ajuste del modelo. La ecuación correspondiente a este modelo es:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{lpsa}=-0.303+0.678\hat{lcavol}+0.511\hat{lweight}</script></span></p>
</center>
#### Datos influyentes
Es posible que entre los datos, existan algunos que son más influyentes que otros a la hora del ajuste, lo que puede producir cierto grado de sesgo. Para determinar la presencia de valores influyentes, se suele analizar la *palanca* o el *leverage* de cada observación. Recordemos que $\hat{y}_{i}=h_{i1}y_1+...+h_{ii}y_i+...+h_{in}y_n$, luego, el coeficiente $h_{ii}$ es la contribución del i-ésimo elemento sobre su valor esperado. Es por ello que $h_{ii}$ se le conoce como *leverage* de la i-ésima observación, siendo $h_{ii}$ el i-ésimo elemento de la diagonal principal de la matriz $\boldsymbol{H}=\boldsymbol{X}(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{X}^T$. Estos elementos son mayores o iguales que cero y menores o iguales a uno y por lo tanto su valor es un indicador directo de la contribución que cada observación tiene sobre su valor esperado. Si la palanca de una observación es grande (cercano a 1) entonces la observación determina su valor esperado sin importar demasiado el resto de las observaciones. Si en cambio las palancas son pequeñas y parecidas, todas las observaciones contribuyen equitativamente en la construcción de
los valores esperados. Existe un criterio heurístico que establece que un dato se considera influyente si su *leverage* supera a la cantidad $\frac{2p}{n}$, donde $p$ es la traza de $\boldsymbol{H}$, la cual a su vez coincide con el rango de $\boldsymbol{X}. Veamos si en nuestros datos hay alguna observación muy influyente.
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; X&lt;-model.matrix(multipleRegSimpl)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; P&lt;-X%*%solve(t(X)%*%X)%*%t(X)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; leverage&lt;-diag(P)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; sum(leverage)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># [1] 3</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; 2*mean(leverage) # punto de corte</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; [1] 0.06185567</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; plot(leverage)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; abline(h=0.06185567, col="violet", lwd=3)</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: Obtenga los <em>leverages</em> usando la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">hatvalues()</code>.</p>
<p><img src="../Imagenes/leverage.png" alt="Figura7"></p>
<h4>Pruebas de hipótesis para comparar modelos</h4>
<p>En la regresión lineal múltiple, la prueba F de significancia de la regresión tiene como hipótesis nula a <span class="math"><script type="math/tex">H_0:~\beta_1= \beta_2 = · · · = \beta_{p−1}= 0</script></span>. Es por ello que podemos ver esta prueba como la comparación de dos modelos, el <em>modelo nulo</em> o modelo bajo hipótesis nula (<span class="math"><script type="math/tex">y_i=\mu_0+\epsilon_i</script></span>) y el <em>modelo completo</em> o modelo bajo hipótesis alternativa (<span class="math"><script type="math/tex">y_i=\mu_0+x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ip-1}\beta_{p-1}+\epsilon_i</script></span>), correspondiente a <span class="math"><script type="math/tex">H_1:Al~menos~un~\beta_i\neq 0,~con~i=1,2,...,p-1</script></span> . De manera que bajo <span class="math"><script type="math/tex">H_0</script></span>, <span class="math"><script type="math/tex">\hat{y}_{0i}=\overline{y}</script></span>, mientras que según el modelo alternativo, <span class="math"><script type="math/tex">\hat{y}_{1i}=\mu_0+x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ip-1}\beta_{p-1}</script></span>. La tabla de ANOVA para descomponer la varianza es:</p>
<table>
<thead>
<tr>
<th>Fuente</th>
<th>Suma de Cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr>
<td>Regresión</td>
<td><span class="math"><script type="math/tex">RMS=\sum\limits_{i=1}^n(\hat{y}_{1i}-\overline{y})^2</script></span></td>
<td><span class="math"><script type="math/tex">p-1</script></span></td>
<td><span class="math"><script type="math/tex">CMR=\frac{RMS}{p-1}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{CMR}{CMRR}</script></span></td>
</tr>
<tr>
<td>Error</td>
<td><span class="math"><script type="math/tex">RSS=\sum\limits_{i=1}^n(y_i-\hat{y}_{1i})^2</script></span></td>
<td><span class="math"><script type="math/tex">n-p</script></span></td>
<td><span class="math"><script type="math/tex">CMRR=\frac{RSS}{n-p}</script></span></td>
<td></td>
</tr>
<tr>
<td>Total</td>
<td><span class="math"><script type="math/tex">\sum\limits_{i=1}^n(y_i-\overline{y})^2</script></span></td>
<td><span class="math"><script type="math/tex">n-1</script></span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Para hacer el test en <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code> vamos a usar la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">anova()</code>:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; null_model &lt;- lm(lpsa ~ 1, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; full_model &lt;- multipleRegSimpl</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(null_model, full_model)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: lpsa ~ 1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: lpsa ~ lcavol + lweight</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     96 127.918                                  </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     94  52.966  2    74.951 66.509 &lt; 2.2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<p>Los resultados del ANOVA no se presentan de la misma forma que en la tabla de varianzas, pero en escencia son los mismos. Según los resultados el valor del estadístico <span class="math"><script type="math/tex">F</script></span> es lo suficientemente grande para rechazar la <span class="math"><script type="math/tex">H_0</script></span>, y por lo tanto asumir como correcto el modelo completo. Notemos que el valor del estadístico <span class="math"><script type="math/tex">F</script></span> del ANOVA es el mismo que obtuvimos al hacer <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">summary(multipleRegSimpl)</code>. Las sumas de cuadrados correspondientes son:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RMS&lt;-sum((fitted(full_model)-fitted(null_model))^2)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RMS</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 74.95133</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS&lt;-sum(residuals(full_model)^2)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 52.96626</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; total&lt;-sum(residuals(null_model)^2)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; total</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 127.9176</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_regresion&lt;-length(coef(full_model))-length(coef(null_model))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_regresion</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 2</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_error&lt;-length(residuals(full_model))-length(coef(full_model))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_error</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 94</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_total&lt;-length(residuals(null_model))-length(coef(null_model))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; GDL_total</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 96</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; F_stat&lt;-(RMS/GDL_regresion)/(RSS/GDL_error)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; F_stat</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p_val&lt;-pf(F_stat, GDL_regresion, GDL_error)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p_val</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 0</span></span></span>
</pre>
<p>Ahora bien, cómo podemos decidir objetivamente entre los dos modelos de regresión multivariada? Una alternativa es comparar los valores de <span class="math"><script type="math/tex">R^2</script></span> ajustado. Tomemos el caso del modelo <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">multipleReg</code> y el modelo <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">multipleRegSimpl</code>. En el primer caso, el <span class="math"><script type="math/tex">R^2</script></span> ajustado fue <span class="math"><script type="math/tex">0.5905</script></span> mientras que en el segundo, <span class="math"><script type="math/tex">0.5771</script></span>. Según este criterio, el modelo más completo sería más adecuado ya que permite explicar mayor proporción de la variabilidad total del modelo. Alternativamente, podemos utilizar una prueba estadística <span class="math"><script type="math/tex">F</script></span> para comparar modelos anidados. Si consideramos el modelo completo</p>
<center>
<p><span class="math"><script type="math/tex">y_i=\mu_0+x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ip-1}\beta_{p-1}+\epsilon_i</script></span></p>
</center>
<p>Este modelo tiene <span class="math"><script type="math/tex">p-1</script></span> variables regresoras para un total de <span class="math"><script type="math/tex">p</script></span> parámetros y sus valores ajustados los denotamos por $\hat{y}_{1i}. Un modelo anidado o reducido de este modelo completo será</p>
<center>
<p><span class="math"><script type="math/tex">y_i=\mu_0+x_{i1}\beta_1+x_{i2}\beta_2+...+x_{ij-1}\beta_{j-1}+\epsilon_i</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">j<p</script></span>. Este modelo tiene <span class="math"><script type="math/tex">j-1</script></span> variables predictoras para un total de <span class="math"><script type="math/tex">j</script></span> parámetros. Los valores ajustados por este modelo los denotaremos por <span class="math"><script type="math/tex">\hat{y}_{0i}</script></span>. La diferencia entre estos dos modelos se puede escribir en forma de hipótesis nula de una prueba F:</p>
<center>
<p><span class="math"><script type="math/tex">H_0:~\beta_j=\beta_{j+1}=...=\beta_{p-1}=0</script></span></p>
</center>
<p>Podemos realizar la prueba de hipótesis usando una prueba F cuya tabla ANOVA es:</p>
<table>
<thead>
<tr>
<th>Fuente</th>
<th>Suma de Cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr>
<td>Diferencia</td>
<td><span class="math"><script type="math/tex">SSD=\sum\limits_{i=1}^n(\hat{y}_{1i}-\hat{y}_{0i})^2</script></span></td>
<td><span class="math"><script type="math/tex">p-j</script></span></td>
<td><span class="math"><script type="math/tex">MSD=\frac{SSD}{p-j}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{MSD}{MSE}</script></span></td>
</tr>
<tr>
<td>Completo</td>
<td><span class="math"><script type="math/tex">SSE=\sum\limits_{i=1}^n(y_i-\hat{y}_{1i})^2</script></span></td>
<td><span class="math"><script type="math/tex">n-p</script></span></td>
<td><span class="math"><script type="math/tex">MSE=\frac{SSE}{n-p}</script></span></td>
<td></td>
</tr>
<tr>
<td>Nulo</td>
<td><span class="math"><script type="math/tex">\sum\limits_{i=1}^n(y_i-\hat{y}_{0i})^2</script></span></td>
<td><span class="math"><script type="math/tex">n-j</script></span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Cabe destacar que la fila correspondiente a la <em>diferencia</em> de los modelos compara la diferencia en la suma de cuadrados de los valores ajustados, cuyos grados de libertad se corresponden con la diferencia entre los grados de libertad del modelo completo y los del modelo nulo o anidado.</p>
<p>En nuestro caso, la hipótesis nula de la prueba será <span class="math"><script type="math/tex">H_0:~\beta_{age}=\beta_{lbph}=\beta_{lcp}=\beta_{pgg45}=0</script></span>, equivalente a <span class="math"><script type="math/tex">y_i=\mu_0+\beta_{lcavol}lcavol_i+\beta_{lweight}lweight_i+\epsilon_i</script></span>, mientras que la alternativa es <span class="math"><script type="math/tex">H_1:~Al~menos~uno~de~\beta_{age},\beta_{lbph},\beta_{lcp},\beta_{pgg45}~es \neq 0</script></span>.</p>
<p>La prueba en <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code> resultan</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(multipleRegSimpl, multipleReg)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: lpsa ~ lcavol + lweight</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: lpsa ~ lcavol + lweight + age + lbph + lcp + pgg45</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     94 52.966                           </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     90 49.103  4    3.8635 1.7704 0.1417</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: obtenga las sumas de cuadrados de los distintos términos del ANOVA.</p>
<p>Los resultados obtenidos indican que, a un nivel de significancia <span class="math"><script type="math/tex">\alpha</script></span> rasonable, no hay evidencias suficientes para rechazar la <span class="math"><script type="math/tex">H_0</script></span> de la prueba, por lo que es posible asumir que los coeficientes de las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">age</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lbph</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcp</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">pgg45</code> son nulos, para quedarnos entonces con el modelo reducido. Teniendo en cuenta además las transformaciones logarítmicas, es posible escribir la ecuación del modelo como:</p>
<center>
<p><span class="math"><script type="math/tex">\hat{psa}_i=e^{-0.30262}(\hat{cavol}^{0.67753}_i\hat{weight}_i^{0.51095})</script></span></p>
</center>
<h4>Predicción y bandas de confianza</h4>
<p>Este modelo no sólo nos permite explicar la variación en la concentración de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">psa</code> debida a los cambios en el volumen tumoral y el peso de la próstata sino que también puede ser utilizado para predecir los valores de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">psa</code> ante nuevos conjuntos de valores de las dos regresoras. En estos casos, resulta fundamental definir la incertidumbre en las predicciones que se realicen con el modelo, mediante bandas de confianza.</p>
<p>Hay dos tipos de predicciones posibles a partir de un conjunto nuevo de observaciones <span class="math"><script type="math/tex">\boldsymbol{x}_0=(cavol_0,~weight_0)</script></span>:</p>
<ul>
<li>
<p>Predecir el valor de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">psa</code> para un paciente cuyos valores de las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">cavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">weight</code> están dados por <span class="math"><script type="math/tex">\boldsymbol{x}_0</script></span>. En este caso, <span class="math"><script type="math/tex">lpsa_0=\boldsymbol{x}_0^T\beta+\epsilon_0</script></span>, como se desconoce el valor de <span class="math"><script type="math/tex">\epsilon_0</script></span>, <span class="math"><script type="math/tex">\hat{lpsa}_0=\boldsymbol{x}_0^T\hat{\beta}</script></span>, pero se debe considerar la varianza de <span class="math"><script type="math/tex">\epsilon_0</script></span> para estimar la varianza de <span class="math"><script type="math/tex">\hat{lpsa}_0</script></span>. Luego <span class="math"><script type="math/tex">V(\hat{lpsa}_0)=V(\boldsymbol{x}_0^T\hat{\beta}+\epsilon_0)=V(\boldsymbol{x}_0^T\hat{\beta})+V(\epsilon_0)=\hat{\sigma}^2(\boldsymbol{x}_0(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{x}_0^T+1)</script></span>.</p>
</li>
<li>
<p>Predecir el valor medio de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">psa</code> para todos aquellos pacientes cuyos valores de las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">cavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">weight</code> están dados por <span class="math"><script type="math/tex">\boldsymbol{x}_0</script></span>. En este caso, <span class="math"><script type="math/tex">\overline{lpsa}_0=\boldsymbol{x}_0^T\beta</script></span>, que será estimado por <span class="math"><script type="math/tex">\boldsymbol{x}_0^T\hat{\beta}</script></span>. De manera entonces que  <span class="math"><script type="math/tex">V(\overline{lpsa}_0)=V(\boldsymbol{x}_0^T\hat{\beta})=\hat{\sigma}^2\boldsymbol{x}_0(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{x}_0^T</script></span>.</p>
</li>
</ul>
<p>Luego, un intervalo de confianza de nivel <span class="math"><script type="math/tex">100(1-\alpha)%</script></span> para una futura respuesta ante la observación <span class="math"><script type="math/tex">\boldsymbol{x}_0</script></span> será:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{x}_0^T\hat{\beta}\pm t^{\frac{\alpha}{2}}_{n-p}\hat{\sigma}\sqrt{1+\boldsymbol{x}_0(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{x}_0^T}</script></span></p>
</center>
<p>Mientras que un intervalo de confianza de nivel <span class="math"><script type="math/tex">100(1-\alpha)%</script></span> para la respuesta promedio dado <span class="math"><script type="math/tex">\boldsymbol{x}_0</script></span> será:</p>
<center>
<p><span class="math"><script type="math/tex">\boldsymbol{x}_0^T\hat{\beta}\pm t^{\frac{\alpha}{2}}_{n-p}\hat{\sigma}\sqrt{\boldsymbol{x}_0(\boldsymbol{X}^T\boldsymbol{X})^{-1}\boldsymbol{x}_0^T}</script></span></p>
</center>
<p>Construyamos los intervalos de confianza para cada uno de los pares observados.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; X&lt;-model.matrix(multipleRegSimpl)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; RSS&lt;-sum(residuals(multipleRegSimpl)^2)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; sigma2Hat&lt;-RSS/(multipleRegSimpl$df.residual)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; hatXX&lt;-diag(X%*%solve(t(X)%*%X)%*%t(X))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; pred&lt;-X%*%matrix(coef(multipleRegSimpl), ncol=1)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; EE_pred&lt;-sqrt(sigma2Hat*(1+hatXX))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; t_IC&lt;-qt(0.975,multipleRegSimpl$df.residual, lower.tail = TRUE)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; IC_upper&lt;-pred+t_IC*EE_pred</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; IC_lower&lt;-pred-t_IC*EE_pred</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; predictions&lt;-data.frame(lower=IC_upper, predicted=pred, upper=IC_upper)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; head(predictions)</span></span></span>
<span class="syntax--text syntax--plain"><span>      </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lower   predicted   upper</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>1 -0.8158328 0.7196150 2.255063</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 2 -0.8090749 0.7198989 2.248873</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 3 -0.8117645 0.7263521 2.264469</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 4 -0.9757429 0.5590050 2.093753</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 5  0.4592342 1.9602684 3.461303</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 6 -0.8955677 0.6358548 2.167277</span></span></span>
</pre>
<p>Si tomamos particularmente el primer caso,</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; X[1,]</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)     lcavol lweight</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1           1 -0.5798185  2.7695</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; predictions[1,]</span></span></span>
<span class="syntax--text syntax--plain"><span>      </span><span class="syntax--meta syntax--paragraph syntax--text"><span>lower   predicted   upper</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>1 -0.8158328 0.7196150 2.255063</span></span></span>
</pre>
<p>El valor de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> para el paciente se encontrará entre <span class="math"><script type="math/tex">-0.816</script></span> y <span class="math"><script type="math/tex">2.255</script></span> con un nivel de confianza del <span class="math"><script type="math/tex">95%</script></span>. En términos de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">psa</code>, el IC será <span class="math"><script type="math/tex">[0.442,9.536]</script></span>.</p>
<h4>Regresión múltiple con covariables cualitativas</h4>
<p>Hasta este momento, los modelos que hemos propuesto sólo se han basado en relaciones aditivas entre covariables numéricas. Sin embargo, los modelos lineales pueden incorporar tanto covariables del tipo categóricas e <em>interacciones</em> entre las covariables para modelar un fenómeno.</p>
<p>En el dataset <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">prostate</code> tenemos dos variables del tipo categóricas: <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">gleason</code>. Observemos por ejemplo la relación entre las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> cuando tenemos en cuenta las categorías de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">gleason</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; table(prostate$svi)</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>0  1</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>76 21</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; table(prostate$gleason)</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>6  7  8  9</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>35 56  1  5</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(prostate, aes(x=lcavol, y=lpsa, color=gleason, shape=svi))+geom_point(size=2, alpha=0.7)+scale_color_manual("Gleason", values = c("6"="red", "7"="blue", "8"="green4", "9"="orange"))</span></span></span>
</pre>
<p><img src="../Imagenes/multiplePoints.png" alt="Figura8"></p>
<p><strong>Figura 8</strong>: Diagrama de dispersión de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> incorporando el <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> y el índice <em>Gleason</em> de cada paciente.</p>
<p>El diagrama de dispersión de la <a href="Figura8">Figura 8</a> devela que, por un lado, los pacientes con <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=0</code> presentan, en su mayoría, los valores de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> más pequeños, mientras que los que tienen <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=1</code>, presentan los valores más elevados de dichas variables. A su vez, si bien el patrón de agrupamiento no es tan claro, parecería ser que los valores de índice Gleason también conglomeran a los pacientes. ¿Qué pasa si queremos incluirl estas variables categóricas en el modelo? ¿Qué implicaría incluirlas  respecto de las rectas de regresión?</p>
<p>Retomemos el modelo de regresión lineal simple:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1lcavol_i+\epsilon_i</script></span></p>
</center>
<p>Consideremos la recta de regresión y el diagrama de dispersión entre las variables, teniendo en cuenta además el <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> de cada observación.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modelo&lt;-lm(lpsa~lcavol, data=prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; coefficients(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)      lcavol</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>  1.5072979   0.7193201</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(prostate, aes(x=lcavol, y=lpsa, shape=svi))+geom_point(size=2, color="red")+geom_abline(intercept = 1.5072979, slope = 0.7193201, color="blue", lwd=1.5, alpha=0.7)</span></span></span>
</pre>
<p><img src="../Imagenes/dispPlot2.png" alt="Figura9"></p>
<p><strong>Figura 9</strong>: Diagrama de dispersión de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> incorporando el <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> de cada paciente y la recta de regresión.</p>
<p><strong>Pregunta</strong>: ¿Qué piensa de la recta de regresión y el ajuste en los extremos?</p>
<p>La incorporación de la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> permitiría corregir el efecto observado en la recta de regresión. En el modelo, esto se representa mediante la creación de una variable <em>dummy</em>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid</code>:</p>
<center>
<p><span class="math"><script type="math/tex">svid=\begin{cases}
      0 & si~svi=No \\
      1 & si~svi=Yes
   \end{cases}</script></span></p>
</center>
<p><strong>Nota</strong> el primer nivel del factor se asume como valor <em>por defecto</em> de la variable y se lo codifica con <span class="math"><script type="math/tex">0</script></span>.</p>
<p>Luego, si <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid=0</code>, el modelo de regresión será:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1 lcavol_i+\epsilon_i</script></span></p>
</center>
<p>Mientras que si <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid=1</code>, el modelo será:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1 lcavol_i+\beta_2+\epsilon_i</script></span></p>
</center>
<p>De esta manera, se tendrán dos rectas de regresión, una para el grupo de pacientes con <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid=0</code> (svi=<em>No</em>) y otra para el grupo de pacientes <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid=1</code> (svi=<em>Yes</em>). En el primer caso, el intercepto será <span class="math"><script type="math/tex">\mu_0</script></span> mientras que en el segundo caso, el intercepto estará dado por <span class="math"><script type="math/tex">\mu_0+\beta_2</script></span>. Cabe destacar que en este modelo, las pendientes de las rectas de regresión se mantendrán iguales. Si quisieramos permitir que las rectas de regresión de  los grupos definidos por la variable <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> sean diferentes, lo que debemos agregar es un término de <em>interacción</em> entre la regresora <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y la variable categórica <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code>. En este caso, la ecuación del modelo será:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1 lcavol_i+\beta_2 svid_i+\beta_3 svid_i lcavol_i+\epsilon_i</script></span></p>
</center>
<p>Luego, si <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid_i=0</code>, el modelo de regresión con interacción será:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1 lcavol_i+\epsilon_i</script></span></p>
</center>
<p>Mientras que si <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svid_i=1</code>, el modelo será:</p>
<center>
<p><span class="math"><script type="math/tex">lpsa_i=\mu_0+\beta_1 lcavol_i+\beta_2+\beta_3 lcavol_i+\epsilon_i</script></span></p>
</center>
<p>De esta manera, para aquellos pacientes en los cuales <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=Yes</code>, <span class="math"><script type="math/tex">\beta_2</script></span> y <span class="math"><script type="math/tex">\beta_3</script></span> representan, respectivamente, la cantidad a adicionar en el intercepto y en la pendiente de la recta de regresión entre <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> correspondiente a los pacientes con <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=No</code>.</p>
<p>Ajustemos estos dos modelos en <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code>:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modeloAditivo&lt;-lm(lpsa~lcavol+svi, data=prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modeloInteraccion&lt;-lm(lpsa~lcavol+svi+lcavol*svi, data=prostate)</span></span></span>
</pre>
<p>Veamos que sucede con el modelo aditivo.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modeloAditivo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = lpsa ~ lcavol + svi, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min      1Q  Median      3Q     Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.6206 -0.5293  0.1201  0.4850  1.6937</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)  1.53343    0.11733  13.070  &lt; 2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol       0.59256    0.07768   7.628 1.91e-11 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>sviYes       0.66975    0.22115   3.029  0.00317 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7557 on 94 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.5804,	Adjusted R-squared:  0.5714</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 65.01 on 2 and 94 DF,  p-value: &lt; 2.2e-16</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; dfResiduals&lt;-rstandard(modeloAditivo)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; shapiro.test(dfResiduals)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#Shapiro-Wilk normality test</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># data:  dfResiduals</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># W = 0.97843, p-value = 0.1109</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g1&lt;-ggplot(data.frame(residuals=dfResiduals), aes(sample=residuals))+stat_qq(distribution = qnorm)+ stat_qq_line()</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g2&lt;-ggplot(data.frame(residuals=dfResiduals, predicted=fitted(modeloAditivo)), aes(x=predicted, y=residuals))+geom_point(color="blue")+labs(y="Residuos estandarizados", x="Valores predichos")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; plot_grid(g1,g2, labels=c("A", "B"))</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: repita el análisis diagnóstico para el modelo con interacción.</p>
<p><img src="../Imagenes/modeloAditivoDiag.png" alt="Figura10"></p>
<p><strong>Figura 10</strong>: Gráficos diagnóstico para el modelo aditivo. <strong>A)</strong> QQ-plot de los residuos estandarizados. <strong>B)</strong> Diagrama de dispersión de los residuos estandarizados vs. los valores predichos por el modelo.</p>
<p>Los resultados del ajuste del modelo indican que éste permite explicar un <span class="math"><script type="math/tex">57.14%</script></span> de la varianza total de los datos. Resultando significativos el intercepto, la pendiente de la recta de regresión de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code> con <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y el coeficiente asociado a la variable dummy correspondiente a <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code>. De esta manera, las ecuaciones del modelo de regresión son:</p>
<ul>
<li>
<p><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=No</code>, <span class="math"><script type="math/tex">\hat{lpsa}_i=1.533+0.5926 lcavol_i</script></span></p>
</li>
<li>
<p><code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi=Yes</code>, <span class="math"><script type="math/tex">\hat{lpsa}_i=1.533+0.5926 lcavol_i+0.67</script></span></p>
</li>
</ul>
<p>Y la gráfica correspondiente a las rectas de regresión es la dada por la <a href="Figura11">Figura 11</a>.</p>
<p><img src="../Imagenes/predictAditivo.png" alt="Figura11"></p>
<p><strong>Figura 11</strong>: Rectas y bandas de regresión para el modelo aditivo.</p>
<p>Analicemos ahora el modelo de interacción.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modeloInteraccion)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = lpsa ~ lcavol + svi + lcavol * svi, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min      1Q  Median      3Q     Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.6305 -0.5007  0.1266  0.4886  1.6847</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>              </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)    1.53970    0.12070  12.757  &lt; 2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol         0.58640    0.08207   7.145 1.98e-10 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>sviYes         0.51385    0.67784   0.758    0.450    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol:sviYes  0.06479    0.26614   0.243    0.808    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7595 on 93 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.5806,	Adjusted R-squared:  0.5671</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 42.92 on 3 and 93 DF,  p-value: &lt; 2.2e-16</span></span></span>
</pre>
<p>Los resultados de las pruebas simples para los coeficientes del modelo indican que la interacción entre las variables <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> no es significativa, por lo que incorporarla al modelo no sería necesario. Probemos esto, es decir, si el cambio en la pendiente de la recta de regresión debido al cambio en el grupo definido por <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code> es o no significativo haciendo una prueba F para modelos anidados. Para ello, debemos tomar como modelo nulo al modelo aditivo y como modelo completo al modelo con interacción.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(modeloAditivo, modeloInteraccion)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: lpsa ~ lcavol + svi</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: lpsa ~ lcavol + svi + lcavol * svi</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     94 53.677                           </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     93 53.643  1  0.034187 0.0593 0.8082</span></span></span>
</pre>
<p>El valor del estadístico <span class="math"><script type="math/tex">F</script></span> de la prueba es lo suficientemente chico para asegurar que no hay evidencias significativas que demuestren que los modelos son diferentes, por lo tanto se asume la hipótesis nula que establece que el modelo reducido es indicado, es decir que se asume <span class="math"><script type="math/tex">H_0:~\beta_3=0</script></span>. Note que el resultado de la prueba t para <span class="math"><script type="math/tex">\beta_3</script></span> es el mismo que el obtenido por esta prueba.</p>
<p>Teniendo en cuenta que el modelo de regresión lineal múltiple incluyendo las regresoras <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lcavol</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lweight</code> resultó mejor que el modelo de regresión lineal simple, también es posible plantear un modelo múltiple aditivo que incorpore la variable categórica <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">svi</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modeloAditivoMultiple&lt;-lm(lpsa~lcavol+lweight+svi, data=prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modeloAditivoMultiple)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = lpsa ~ lcavol + lweight + svi, data = prostate)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>     </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min       1Q   Median       3Q      Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-1.72964 -0.45764  0.02812  0.46403  1.57013</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept) -0.26809    0.54350  -0.493  0.62298    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lcavol       0.55164    0.07467   7.388  6.3e-11 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lweight      0.50854    0.15017   3.386  0.00104 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>sviYes       0.66616    0.20978   3.176  0.00203 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.7168 on 93 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.6264,	Adjusted R-squared:  0.6144</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 51.99 on 3 and 93 DF,  p-value: &lt; 2.2e-16</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(modeloAditivo, modeloAditivoMultiple)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: lpsa ~ lcavol + svi</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: lpsa ~ lcavol + lweight + svi</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     94 53.677                                </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     93 47.785  1    5.8924 11.468 0.001039 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: Analice los resultados y concluya acerca de qué modelo es más adecuado para estimar <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lpsa</code>. Escriba la ecuación del modelo elegido.</p>
<h2>Modelos lineales para experimentos factoriales</h2>
<p>Los experimentos factoriales son aquellos que intentan determinar el efecto de los niveles o combinaciones de niveles de distintos factores sobre una o más variables respuestas. En el caso de los modelos lineales, la variable respuesta siempre es numérica y se asume con distribución normal y los factores son variables categóricas, nominales u ordinales, con más de una categoría o nivel. Un experimento factorial involucra un <em>diseño factorial</em>, es decir un diseño experimental basado en los niveles de los factores a evaluar. Un buen diseño factorial buscará evaluar todos los niveles y/o combinaciones de niveles de los distintos factores en al menos más de una unidad experimental. El diseño podrá ser balanceado o desbalanceado, según las posibilidades y el objetivo del estudio.</p>
<p>El ejemplo más sencillo de un experimento factorial es aquel donde sólo se considera un factor con dos niveles. A menudo uno de estos dos niveles es el <em>control</em> o <em>referencia</em> mientras que el otro es el <em>tratamiento</em>. Los sujetos experimentales son asignados aleatoriamente a uno de estos dos grupos, reciben el tratamiento correspondiente, y luego se les mide alguna cantidad indicadora que será la variable respuesta. Matemáticamente, se puede definir el modelo para la variable respuesta <span class="math"><script type="math/tex">y_{ij}\sim N(\mu_i,\sigma^2)</script></span>, donde <span class="math"><script type="math/tex">i=1,~2</script></span> indica el nivel del factor experimental y <span class="math"><script type="math/tex">j=1,~2,...,~n_i</script></span>, donde <span class="math"><script type="math/tex">n_i</script></span> es el número de individuos que del grupo correspondiente al i-ésimo nivel del factor. Este modelo asume que las observaciones de la variable respuesta siguen una distribución normal, con media diferente para cada grupo experimental, y misma varianza, y además que asume independencia entre las observaciones. La pregunta razonable sería ¿son iguales las medias de la variable respuesta de los grupos experimentales?, es decir, <span class="math"><script type="math/tex">H_0:~\mu_1=\mu_2~vs. ~H_1: \mu_1 \neq \mu_2</script></span>. Esta pregunta puede ser respondida con una prueba de hipótesis t para la media de dos poblaciones, cuyo estadístico sigue distribución t con <span class="math"><script type="math/tex">n_1+n_2-1</script></span> grados de libertad.</p>
<p>Tomemos como ejemplo el conjunto de datos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">melatonin</code>, el cual contiene un experimento realizado para evaluar los efectos de la melatonina en la duración del sueño. Para ello se estudió un grupo aleatorio de 20 sujetos adultos de sexo masculino, 10 de los cuales fueron aleatoriamente seleccionados como grupo control mientras que los 10 restantes conformaron el grupo tratado. A los sujetos del grupo control se les administró placebo y a los del grupo tratado 5mg de melatonina antes de ir a dormir y luego se midió a todos ellos la duración del sueño en horas. A un nivel de significancia <span class="math"><script type="math/tex">\alpha=0.1</script></span> los investigadores quieren saber si hubo un efecto de la melatonina sobre la duración del sueño.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; melatonin&lt;-data.frame(sleep=c(8.145150,7.522362,6.935754,8.959435,6.985122, 8.072651,8.313826,8.086409, 8.922108, 8.124743,8.065844, 10.943974, 4.833367, 7.865453, 6.340014, 8.963140, 6.158896, 5.012253, 3.571440, 9.784136 ), group = factor(rep(c("control", "treatment"),10)))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(melatonin, aes(x=group, y=sleep, fill=group))+geom_boxplot()+theme(legend.position = "none")+labs(x="Grupo", y="Horas de sueño")+scale_x_discrete(labels=c("control"="Control", "treatment"="Tratados"))</span></span></span>
</pre>
<p><img src="../Imagenes/boxplotMelatonina.png" alt="Figura12"></p>
<p><strong>Figura 12</strong>: Diagrama de cajas para las horas de sueño en los grupos control y tratado con melatonina.</p>
<p>Buscamos probar si <span class="math"><script type="math/tex">H_0:~\mu_T=\mu_C</script></span> vs <span class="math"><script type="math/tex">H_1:~\mu_T\neq \mu_C</script></span>. Para ello, usamos la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">t.test()</code> de <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">R</code>, especificando que las varianzas se asumen iguales (<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">var.equal=TRUE</code>).</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; t.test(sleep~group, data=melatonin, var.equal=TRUE)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Two Sample t-test</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># data:  sleep by group</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># t = -2.0854, df = 18, p-value = 0.05154</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># alternative hypothesis: true difference in means is not equal to 0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 95 percent confidence interval:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#     -3.02378251  0.01117551</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># sample estimates:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#     mean in group control mean in group treatment</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 6.827152                8.333456</span></span></span>
</pre>
<p>A un nivel de significancia <span class="math"><script type="math/tex">\alpha=0.1</script></span> hay evidencias suficientes para rechazar <span class="math"><script type="math/tex">H_0</script></span>, asumiendo entonces que la melatonina tienen un efecto significativo en las horas de sueño de los sujetos. Más aún, los sujetos tratados con melatonina duermen, en promedio, 1.5 hs más que los del grupo control. Ahora bien, cómo lo haríamos si tuviesemos más de dos grupos experimentales? Para ello se utilizan los <em>modelos lineales de clasificación</em>.</p>
<h3>Modelo de clasificación unifactorial</h3>
<p>Consideremos el modelo lineal</p>
<center>
<p><span class="math"><script type="math/tex">y_{ij}=\mu_0+\beta_i x_{ij}+\epsilon_{ij}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">\beta_i</script></span> es el coeficiente asociado a una variable <em>dummy</em>, <span class="math"><script type="math/tex">x_i</script></span>, que indica si la observación pertenece (1) o no (0) al grupo <span class="math"><script type="math/tex">i</script></span> y <span class="math"><script type="math/tex">\epsilon_{ij} \sim N(0, \sigma^2)</script></span>, <span class="math"><script type="math/tex">i=1,2,..., g</script></span> donde <span class="math"><script type="math/tex">g</script></span> indica el número de grupos y <span class="math"><script type="math/tex">j=1, 2, ..., n_i</script></span>, donde <span class="math"><script type="math/tex">n_i</script></span> es el número de observaciones del grupo <span class="math"><script type="math/tex">i</script></span> de manera que <span class="math"><script type="math/tex">N=\sum n_i</script></span> es el tamaño muestral.</p>
<p>Este modelo se puede escribir de la forma</p>
<center>
<p><span class="math"><script type="math/tex">y_{ij}=\mu_0+\alpha_i+\epsilon_{ij}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">\sum \alpha_i=0</script></span>. De manera que las observaciones del grupo <span class="math"><script type="math/tex">i</script></span> siguen distribución normal,</p>
<center>
<p><span class="math"><script type="math/tex">y_{ij}\sim N(\mu_i=\mu_0+\alpha_i, \sigma^2)</script></span></p>
</center>
<p>Luego, <span class="math"><script type="math/tex">\alpha_i</script></span> es el efecto del grupo <span class="math"><script type="math/tex">i</script></span> que representa la diferencia entre la media general <span class="math"><script type="math/tex">\mu_0</script></span> y la media del grupo <span class="math"><script type="math/tex">i</script></span>. Las hipítesis de este modelo son las mismas que las de la prueba t para dos grupos, sólo que ahora tenemos más grupos. La hipótesis nula de la prueba que evalua si las medias grupales son iguales es:</p>
<center>
<p><span class="math"><script type="math/tex">H_0:~\mu_1=\mu_2=...=\mu_g</script></span> vs <span class="math"><script type="math/tex">H_1:~No~todas~las~\mu_i~son~iguales.</script></span></p>
</center>
<p>O, equivalentemente,</p>
<center>
<p><span class="math"><script type="math/tex">H_0:~\alpha_1=\alpha_2=...=\alpha_g=0</script></span> vs <span class="math"><script type="math/tex">H_1:~Al~menos~un~\alpha_i\neq 0.</script></span></p>
</center>
<p>Esta prueba es en sí un <em>Análisis de la Varianza</em> (ANOVA) ya que compara las medias de diferentes grupos mediante el análisis de la variabilidad <em>entre</em> grupos y de la variabilidad <em>dentro</em> de los grupos. Teniendo en cuenta que:</p>
<ul>
<li><span class="math"><script type="math/tex">\overline{y}_i</script></span> es la media del grupo <span class="math"><script type="math/tex">i</script></span></li>
<li><span class="math"><script type="math/tex">\overline{y}</script></span> es la media general</li>
<li><span class="math"><script type="math/tex">s_i^2</script></span> es la varianza mustral del grupo <span class="math"><script type="math/tex">i</script></span></li>
</ul>
<p>es posible descomponer la varianza, como lo hicimos anteriormente en los modelos de regresión. La variabilidad total mide la dispersión entre las observaciones y la media general ignorando los distintos grupos:</p>
<center>
<p><span class="math"><script type="math/tex">SST=\sum\limits_{i=1}^g\sum\limits_{j=1}^{n_i}(y_{ij}-\overline{y})^2</script></span></p>
</center>
<p>La variabilidad <em>entre</em> grupos explica cuanto se alejan las medias muestrales de cada grupo respecto de la media general:</p>
<center>
<p><span class="math"><script type="math/tex">SSB=\sum\limits_{i=1}^g\sum\limits_{j=1}^{n_i}(\overline{y}_{i}-\overline{y})^2=\sum\limits_{i=1}^g n_i(\overline{y}_{i}-\overline{y})^2</script></span></p>
</center>
<p>La variabilidad <em>dentro</em>  de los grupos explica cuanto se alejan las observaciones de la media muestral de su grupo:</p>
<center>
<p><span class="math"><script type="math/tex">SSW=\sum\limits_{i=1}^g\sum\limits_{j=1}^{n_i}(y_{ij}-\overline{y}_i)^2=\sum\limits_{i=1}^g (n_i-1)s_{i}^2</script></span></p>
</center>
<p>Para desarrollar la prueba ANOVA, arreglemos estos valores en una tabla:</p>
<table>
<thead>
<tr>
<th>Fuente</th>
<th>Suma de Cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr>
<td>Entre</td>
<td><span class="math"><script type="math/tex">SSB</script></span></td>
<td><span class="math"><script type="math/tex">g-1</script></span></td>
<td><span class="math"><script type="math/tex">MSB=\frac{SSB}{g-1}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{MSB}{MSW}</script></span></td>
</tr>
<tr>
<td>Dentro</td>
<td><span class="math"><script type="math/tex">SSW</script></span></td>
<td><span class="math"><script type="math/tex">N-g</script></span></td>
<td><span class="math"><script type="math/tex">MSW=\frac{SSW}{N-g}</script></span></td>
<td></td>
</tr>
<tr>
<td>Total</td>
<td><span class="math"><script type="math/tex">SST</script></span></td>
<td><span class="math"><script type="math/tex">N-1</script></span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Bajo hipótesis nula, el estadístico F de la prueba tiene distribución <span class="math"><script type="math/tex">F</script></span> con <span class="math"><script type="math/tex">g-1</script></span>, <span class="math"><script type="math/tex">N-g</script></span> grados de libertad. Por lo que rechazaremos la hipótesis nula (igualdad de medias) si F es lo suficientemente grande.</p>
<p>Tomemos como ejemplo el conjunto de datos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">coagulation</code> del paquete <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">faraway</code>. Este dataset se corresponde con un experimento donde se administró en forma aleatoria cuatro dietas diferentes (<code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">C</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">D</code>) a una muestra aleatoria de 24 animales. Luego se midió a cada uno de ellos el tiempo de coagulación de la sangre (en segundos) con el objetivo de determinar si la dieta tiene efecto sobre éste.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; data(coagulation, package="faraway")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; head(coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># coag diet</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 1   62    A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 2   60    A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 3   63    A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 4   59    A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 5   63    B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 6   67    B</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; table(coagulation$diet)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># A B C D</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># 4 6 6 8</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ggplot(coagulation, aes(x=diet, y=coag, fill=diet))+geom_boxplot()+theme(legend.position = "none")+labs(x="Dieta", y="Tiempo de coagulación")</span></span></span>
</pre>
<p>La <a href="Figura13">Figura 13</a> ilustra los diagramas de caja del tiempo de coagulación para los cuatro grupos de animales. ¿Cómo hacemos para comparar estadísticamente las distribuciones del tiempo de coagulación en estos cautro grupos?</p>
<p><img src="../Imagenes/boxplotCoag.png" alt="Figura13"></p>
<p><strong>Figura 13</strong>: Diagramas de caja para el tiempo de coagulación de los cuatro grupos de animales correspondientes a cuatro dietas diferentes.</p>
<p>Buscamos probar si <span class="math"><script type="math/tex">H_0:~\mu_A=\mu_B=\mu_C=\mu_D</script></span>, donde, por ejemplo, <span class="math"><script type="math/tex">\mu_A</script></span> es el tiempo de coagulación promedio para un animal que sigue la dieta <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>. La <a href="Figura13">Figura 13</a> sugiere una posible diferencia de medias, la cual podemos probar mediante un ANOVA del modelo lineal</p>
<center>
<p><span class="math"><script type="math/tex">coag_{ij}=\mu_0+\alpha_i+\epsilon_{ij}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">i= 1, 2, 3, 4</script></span>, <span class="math"><script type="math/tex">j=1, ..., 24</script></span> y <span class="math"><script type="math/tex">\epsilon_{ij} \sim N(0, \sigma^2)</script></span>. Ajustemos el modelo lineal utilizando la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lm()</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; modelo&lt;-lm(coag~diet, data=coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = coag ~ diet, data = coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>   </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min     1Q Median     3Q    Max</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>-5.00  -1.25   0.00   1.25   5.00</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>             </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept) 6.100e+01  1.183e+00  51.554  &lt; 2e-16 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>dietB       5.000e+00  1.528e+00   3.273 0.003803 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>dietC       7.000e+00  1.528e+00   4.583 0.000181 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>dietD       2.991e-15  1.449e+00   0.000 1.000000    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 2.366 on 20 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.6706,	Adjusted R-squared:  0.6212</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 13.57 on 3 and 20 DF,  p-value: 4.658e-05</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; model.matrix(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept) dietB dietC dietD</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1            1     0     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2            1     0     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>3            1     0     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>4            1     0     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>5            1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>6            1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>7            1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>8            1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>9            1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>10           1     1     0     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>11           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>12           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>13           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>14           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>15           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>16           1     0     1     0</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>17           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>18           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>19           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>20           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>21           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>22           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>23           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>24           1     0     0     1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>attr(,"assign")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] 0 1 1 1</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>attr(,"contrasts")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>attr(,"contrasts")$`diet`</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>[1] "contr.treatment"</span></span></span>
</pre>
<p><strong>Nota</strong>: La formulación <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">coag~diet</code> permite que la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">lm()</code> asuma un grupo por defecto, por lo que el coeficiente <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">intercept</code> en realidad refiere a la suma de la media general más el <span class="math"><script type="math/tex">\alpha_i</script></span> correspondiente al grupo por defecto, que siempre será el primer nivel del factor que especifica el tratamiento. Para obtener los resultados discriminando el <span class="math"><script type="math/tex">\mu_0</script></span> de los <span class="math"><script type="math/tex">\alpha_i</script></span> se debe usar la fórmula <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">coag~diet-1</code>.</p>
<p>Los resultados de la prueba <span class="math"><script type="math/tex">F</script></span> indican que hay una diferencia significativa en el valor promedio del tiempo de coagulación entre los distintos grupos. El grupo de referencia es el de la dieta <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, que tiene una media del tiempo de coagulación de 60 segundos. Los coeficientes asociados a las dietas <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">C</code> son significativos, mientras que el de la dieta <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">D</code> no lo es, lo cual indica que no hay diferencias significativas en el tiempo de coagulación promedio de aquellos individuos con dieta <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">D</code> respecto de los individuos con dieta <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>.</p>
<p>El ANOVA del modelo puede obtenerse con la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">anova()</code> o con la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">aov()</code></p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Response: coag</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>diet       3    228    76.0  13.571 4.658e-05 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals 20    112     5.6                      </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; aov(coag~diet, data=coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span>   </span><span class="syntax--meta syntax--paragraph syntax--text"><span>aov(formula = coag ~ diet, data = coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Terms:</span></span></span>
<span class="syntax--text syntax--plain"><span>                </span><span class="syntax--meta syntax--paragraph syntax--text"><span>diet Residuals</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Sum of Squares   228       112</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Deg. of Freedom    3        20</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 2.366432</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimated effects may be unbalanced</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(aov(coag~diet, data=coagulation))</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>diet         3    228    76.0   13.57 4.66e-05 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals   20    112     5.6                     </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<p>Realicemos algunas pruebas diagnóstico sobre el modelo.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g1&lt;-ggplot(data.frame(residuals=dfResiduals), aes(sample=residuals))+stat_qq(distribution = qnorm, color="blue")+ stat_qq_line()</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g2&lt;-ggplot(data.frame(residuals=dfResiduals, predicted=fitted(modelo)), aes(x=predicted, y=residuals))+geom_point(color="blue")+labs(y="Residuos estandarizados", x="Valores predichos")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p&lt;-plot_grid(g1,g2, labels=c("A)", "B)"), nrow=1)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; shapiro.test(residuals(modelo))</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Shapiro-Wilk normality test</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># data:  residuals(modelo)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># W = 0.97831, p-value = 0.8629</span></span></span>
</pre>
<p><img src="../Imagenes/diagCoagulation.png" alt="Figura14"></p>
<p><strong>Figura 14</strong>: Gráficos diagnósticos del modelo de tiempo de coagulación en función de la dieta. <strong>A)</strong> QQ-plot de los residuos estandarizados. <strong>B)</strong> Diagrama de dispersión de valores predichos vs. residuos estandarizados.</p>
<p>La <a href="Figura14">Figura 14</a> contiene gráficos dignósticos para el modelo de clasificación. Cabe destacar que como los tiempos de coagulación están medidos en segundos enteros, los valores ajustados también son enteros por lo que aparece cierto patron discreto obvio tanto en el qqplot (<a href="Figura14">Figura 14A</a>) como en el gráfico de dispersión de los residuos vs. valores predichos (<a href="Figura14">Figura 14B</a>). Por supuesto que esta característica discreta no es propia de la distribución normal, sin embargo, los residuos estandarizados ajustan lo suficiente a una distribución normal.</p>
<p>La hipótesis de homogeneidad de la varianza del error puede examinarse en la <a href="Figura14">Figura 14B</a> y complementarse con la prueba de Levene. Esta prueba calcula los valores absolutos de los residuos y los utiliza como salida de un nuevo modelo de clasificación unifactorial. Un valor significativo del estadístico <span class="math"><script type="math/tex">F</script></span> del modelo indica ausencia de homogeneidad de varianza. Aplicado a nuestro ejemplo, la prueba de Levene es</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; med &lt;- with (coagulation, tapply (coag, diet, median))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; ar &lt;- with (coagulation, abs (coag-med[diet] ) )</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova (lm(ar~diet, coagulation))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>#</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Response: ar</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># diet       3  4.333  1.4444  0.6492 0.5926</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span># Residuals 20 44.500  2.2250</span></span></span>
</pre>
<p>Como se puede apreciar, a un nivel de significancia <span class="math"><script type="math/tex">\alpha</script></span> razonable, el estadístico <span class="math"><script type="math/tex">F</script></span> es lo suficientemente grande para no rechazar la hipótesis nula de homogeneidad de varianza, por lo que asumimos que los residuos son homocedásticos.</p>
<p>Finalmente, es de interés conocer las diferencias específicas que existen entre las medias de los distintos grupos, comparados de a pares. Para ello, es necesaria una prueba de comparaciones múltiples como la <em>prueba de Tuckey HSD</em> (<em>Honest Significant Diference</em>). Esta prueba se basa en la distribución del rango estudentizado que es la distribución que sigue la diferencia del máximo y del mínimo de las diferencias entre la media muestral y la media poblacional de g variables normales estándar independientes e idénticamente distribuidas. Para realizarla podemos usar la función <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">TukeyHSD()</code>.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; TukeyHSD(aov(coag~diet, data=coagulation), conf.level = 0.95)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Tukey multiple comparisons of means</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>95% family-wise confidence level</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Fit: aov(formula = coag ~ diet, data = coagulation)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>$`diet`</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>diff         lwr       upr     p adj</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B-A    5   0.7245544  9.275446 0.0183283</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C-A    7   2.7245544 11.275446 0.0009577</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-A    0  -4.0560438  4.056044 1.0000000</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C-B    2  -1.8240748  5.824075 0.4766005</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-B   -5  -8.5770944 -1.422906 0.0044114</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-C   -7 -10.5770944 -3.422906 0.0001268</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>plot(TukeyHSD(coag_aov, conf.level = 0.95))</span></span></span>
</pre>
<p><img src="../Imagenes/tukeyCoag.png" alt="Figura15"></p>
<p><strong>Figura 15</strong>: Intervalos de confianza para la diferencia de media entre grupos, comparados de a dos, en base a los resultados de la Prueba de Tukey.</p>
<p>En base a los resultados podemos concluir que hay diferencias siginificativas entre las medias de los grupos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">C</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">D</code>, <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">C</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">D</code>.</p>
<h3>Modelo de clasificación bifactorial</h3>
<p>¿Qué sucede si tenemos más de un factor en nuestro experimento? Supongamos un experimento donde tenemos dos factores <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> y <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, con <span class="math"><script type="math/tex">I</script></span> y <span class="math"><script type="math/tex">J</script></span> niveles, respectivamente. Ahora, consideremos el modelo:</p>
<center>
<p><span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\delta_{ij}+\epsilon_{ijk}</script></span></p>
</center>
<p>donde <span class="math"><script type="math/tex">\epsilon_{ijk}</script></span> son variables iid. con distribución <span class="math"><script type="math/tex">\sim N(0,\sigma^2)</script></span>, <span class="math"><script type="math/tex">\delta_{ij}=(\alpha_i\beta_j)</script></span>, <span class="math"><script type="math/tex">\sum \alpha_i =\sum \beta_j =0</script></span> y:</p>
<ul>
<li><span class="math"><script type="math/tex">i=1,...,I</script></span></li>
<li><span class="math"><script type="math/tex">j=1,...,J</script></span></li>
<li><span class="math"><script type="math/tex">k=1, ..., K</script></span>, donde <span class="math"><script type="math/tex">K</script></span> es el número de <em>réplicas</em> por grupo experimental.</li>
</ul>
<p>En este modelo, los grupos experimentales están definidos por las diferentes combinaciones de cada uno de los niveles de los factores experimentales. Esta configuración es conocida como un <em>Diseño Factorial</em> <span class="math"><script type="math/tex">IxJ</script></span> con <span class="math"><script type="math/tex">K</script></span> réplicas. De este modo, <span class="math"><script type="math/tex">\alpha_i</script></span> mide el efecto del <em>i-ésimo</em> nivel del factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> sobre la variable respuesta y <span class="math"><script type="math/tex">\beta_j</script></span> mide el efecto del <em>j-ésimo</em> nivel del factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code> sobre la variable respuesta. Estos efectos se conocen como <em>efectos principales</em>. <span class="math"><script type="math/tex">\delta_{ij}</script></span> mide el efecto de la interacción entre dos efectos principales sobre la variable respuesta. A partir de esta configuración se desprenden un conjunto de diferentes modelos que pueden ser comparados.</p>
<p>Tomemos como ejemplo un diseño factorial <span class="math"><script type="math/tex">3x2</script></span>, es decir, el factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> tiene 3 niveles (1, 2 y 3) y el factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code> tiene 2 niveles (1, 2). A partir de este diseño podemos construir los siguientes modelos, cuyas medias por grupo se muestran en las tablas contiguas:</p>
<p><strong>Modelo de interacción</strong>: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\delta_{ij}+\epsilon_{ijk}</script></span>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 1</th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Factor</strong> <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, <strong>nivel 1</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1+\beta_1+\delta_{11}</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1+\beta_2+\delta_{12}</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 2</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2+\beta_1+\delta_{21}</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2+\beta_2+\delta_{22}</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 3</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3+\beta_1+\delta_{31}</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3+\beta_2+\delta_{32}</script></span></td>
</tr>
</tbody>
</table>
<p><strong>Modelo aditivo</strong>: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\epsilon_{ijk}</script></span>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 1</th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 1</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1+\beta_2</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 2</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2+\beta_2</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 3</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3+\beta_2</script></span></td>
</tr>
</tbody>
</table>
<p><strong>Modelo un sólo factor, A</strong>: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\epsilon_{ijk}</script></span>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 1</th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 1</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_1</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 2</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_2</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 3</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\alpha_3</script></span></td>
</tr>
</tbody>
</table>
<p><strong>Modelo un sólo factor, B</strong>: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\beta_j+\epsilon_{ijk}</script></span>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 1</th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 1</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_2</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 2</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_2</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 3</strong></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_1</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0+\beta_2</script></span></td>
</tr>
</tbody>
</table>
<p><strong>Modelo nulo</strong>: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\epsilon_{ijk}</script></span>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 1</th>
<th>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>, nivel 2</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 1</strong></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 2</strong></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
</tr>
<tr>
<td><strong>Factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code>, nivel 3</strong></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
<td><span class="math"><script type="math/tex">\mu_0</script></span></td>
</tr>
</tbody>
</table>
<p>La pregunta que surge entonces es ¿cuál de estos modelos debemos usar? Lo primero que debemos cuestionarnos es si debemos usar o no el modelo de interacción. Es el mismo el efecto del factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">A</code> sobre todos los niveles del factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code>? En el modelo aditivo si lo es, pero no lo es en el modelo de interacción.</p>
<p>Tomemos como ejemplo el conjunto de datos <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">rats</code> del paquete <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">faraway</code>. Este conjunto de datos consiste de observaciones de 48 ratas que fueron aleatoriamente seleccionadas y divididas en 12 grupos experimentales, cada uno de los cuales contó con 4 réplicas. Cada grupo experimental consistió de la combinación de tres venenos y cuatro posibles tratamientos. Luego, se determinó el tiempo de sobrevida en las ratas en decenas de horas.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; data(rats, package="faraway")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; head(rats)</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>time poison treat</span></span></span>
<span class="syntax--text syntax--plain"><span> </span><span class="syntax--meta syntax--paragraph syntax--text"><span>1 0.31      I     A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 2 0.82      I     B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 3 0.43      I     C</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 4 0.45      I     D</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 5 0.45      I     A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span> 6 1.10      I     B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; table(rats[,-1])</span></span></span>
<span class="syntax--text syntax--plain"><span>         </span><span class="syntax--meta syntax--paragraph syntax--text"><span>treat</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>poison  A B C D</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I   4 4 4 4</span></span></span>
<span class="syntax--text syntax--plain"><span>   </span><span class="syntax--meta syntax--paragraph syntax--text"><span>II   4 4 4 4</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>III   4 4 4 4</span></span></span>
</pre>
<p>Realicemos algunos gráficos para explorar las posibles relaciones entre los factores y la variable respuesta.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g1&lt;-ggplot(rats, aes(x = poison, y = time, color =treat, group = treat)) +</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>stat_summary(fun.y = mean, geom = "point", size=2) +</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>    stat_summary(fun.y = mean, geom = "line", size=2)+labs(x="Veneno", y="Tiempo sobrevida", color="Tratamiento")</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; g2&lt;-ggplot(rats, aes(x = treat, y = time, color =poison, group = poison)) +</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>stat_summary(fun.y = mean, geom = "point", size=2) +</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>    stat_summary(fun.y = mean, geom = "line", size=2)+labs(x="Tratamiento", y="Tiempo sobrevida", color="Veneno")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p&lt;-plot_grid(g1,g2, labels=c("A)", "B)"), nrow=1)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; p</span></span></span>
</pre>
<p><img src="../Imagenes/interactionPlotRats.png" alt="Figura16"></p>
<p><strong>Figura 16</strong>: Gráficos de interacción entre la variable respuesta, <em>Tiempo de sobrevida</em>, y los factores experimentales, <em>Veneno</em> y <em>Tratamiento</em>.</p>
<p>Si no hubiese interacción entre los factores <em>Veneno</em> y <em>Tratamiento</em>, en los gráficos de la <a href="Figura16">Figura 16</a> esperaríamos ver todas líneas paralelas, caso en el que un modelo aditivo sería el adecuado. Según los resultados de las gráficas, parece ser que cuando cambia el nivel de un factor, entonces cambia el valor de la variable respuesta, <em>Tiempo de sobrevida</em>. Además los cambios en los niveles de los dos factores parece que modifican en diferente forma a la variable respuesta. Lo que resta saber si estos cambios son o no significativos. Para determinar esto, vamos a construir los diferentes modelos y luego comprarlos entre sí.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; interactionModel&lt;-lm(time~poison+treat+poison:treat, data=rats)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; additiveModel&lt;-lm(time~poison+treat, data=rats)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; poisonModel&lt;-lm(time~poison, data=rats)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; treatModel&lt;-lm(time~treat, data=rats)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; nullModel&lt;-lm(time~1, data=rats)</span></span></span>
</pre>
<p>Exploremos ahora las medias de cada grupo estimadas por los diferentes modelos:</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; rats_table &lt;-expand.grid(poison = unique(rats$poison), treat = unique(rats$treat))</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; rats_table</span></span></span>
<span class="syntax--text syntax--plain"><span>   </span><span class="syntax--meta syntax--paragraph syntax--text"><span>poison treat</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1       I     A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2      II     A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>3     III     A</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>4       I     B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>5      II     B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>6     III     B</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>7       I     C</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>8      II     C</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>9     III     C</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>10      I     D</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>11     II     D</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>12    III     D</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means = function(model, table) {</span></span></span>
<span class="syntax--text syntax--plain"><span>      </span><span class="syntax--meta syntax--paragraph syntax--text"><span>mat = matrix(predict(model, table), nrow = 4, ncol = 3, byrow = TRUE)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>      colnames(mat) = c("I", "II", "III")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>      rownames(mat) = c("A", "B", "C", "D")</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>      mat</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>}</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means(model = interactionModel, table = rats_table)</span></span></span>
<span class="syntax--text syntax--plain"><span>       </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I     II   III</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>A 0.4125 0.3200 0.210</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B 0.8800 0.8150 0.335</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C 0.5675 0.3750 0.235</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D 0.6100 0.6675 0.325</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means(model = additiveModel, table = rats_table)</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I        II       III</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>A 0.4522917 0.3791667 0.1110417</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B 0.8147917 0.7416667 0.4735417</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C 0.5306250 0.4575000 0.1893750</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D 0.6722917 0.5991667 0.3310417</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means(model = poisonModel, table = rats_table)</span></span></span>
<span class="syntax--text syntax--plain"><span>       </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I       II     III</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>A 0.6175 0.544375 0.27625</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B 0.6175 0.544375 0.27625</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C 0.6175 0.544375 0.27625</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D 0.6175 0.544375 0.27625</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means(model = treatModel, table = rats_table)</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I        II       III</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>A 0.3141667 0.3141667 0.3141667</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B 0.6766667 0.6766667 0.6766667</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C 0.3925000 0.3925000 0.3925000</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D 0.5341667 0.5341667 0.5341667</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; get_est_means(model = nullModel, table = rats_table)</span></span></span>
<span class="syntax--text syntax--plain"><span>         </span><span class="syntax--meta syntax--paragraph syntax--text"><span>I       II      III</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>A 0.479375 0.479375 0.479375</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B 0.479375 0.479375 0.479375</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C 0.479375 0.479375 0.479375</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D 0.479375 0.479375 0.479375</span></span></span>
</pre>
<p>Para poder comparar los modelos anidados debemos crear primero la tabla de ANOVA:</p>
<table>
<thead>
<tr>
<th>Fuente</th>
<th>Suma de Cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr>
<td>Factor A</td>
<td><span class="math"><script type="math/tex">SSA</script></span></td>
<td><span class="math"><script type="math/tex">I-1</script></span></td>
<td><span class="math"><script type="math/tex">MSA=\frac{SSA}{I-1}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{MSA}{MSE}</script></span></td>
</tr>
<tr>
<td>Factor B</td>
<td><span class="math"><script type="math/tex">SSB</script></span></td>
<td><span class="math"><script type="math/tex">J-1</script></span></td>
<td><span class="math"><script type="math/tex">MSB=\frac{SSB}{J-1}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{MSB}{MSE}</script></span></td>
</tr>
<tr>
<td>Interacción AB</td>
<td><span class="math"><script type="math/tex">SSAB</script></span></td>
<td><span class="math"><script type="math/tex">(I-1)(J-1)</script></span></td>
<td><span class="math"><script type="math/tex">MSAB=\frac{SSAB}{(I-1)(J-1)}</script></span></td>
<td><span class="math"><script type="math/tex">\frac{MSAB}{MSE}</script></span></td>
</tr>
<tr>
<td>Error</td>
<td><span class="math"><script type="math/tex">SSE</script></span></td>
<td><span class="math"><script type="math/tex">IJ(K-1)</script></span></td>
<td><span class="math"><script type="math/tex">MSE=\frac{SSE}{IJ(K-1)}</script></span></td>
<td></td>
</tr>
<tr>
<td>Total</td>
<td><span class="math"><script type="math/tex">SST</script></span></td>
<td><span class="math"><script type="math/tex">IJK-1</script></span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>De esta manera, para evaluar la interacción <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">AB</code>, la hipótesis nula de la prueba es <span class="math"><script type="math/tex">H_0:~todos~\delta_{ij}=0</script></span> vs. <span class="math"><script type="math/tex">H_1:~al~menos~un~\delta_{ij} \neq 0</script></span>, siendo:</p>
<ul>
<li>Modelo nulo: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\epsilon_{ijk}</script></span></li>
<li>Modelo alternativo: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\delta_{ij}+\epsilon_{ijk}</script></span></li>
</ul>
<p>Rechazaremos esta hipótesis nula cuando el estadístico F sea lo suficientemente grande. Bajo <span class="math"><script type="math/tex">H_0</script></span> <span class="math"><script type="math/tex">F\sim F_{(I-1)(J-1),IJ(K-1)}</script></span>.</p>
<p>De manera análoga, la prueba para evaluar el factor <code style="font-family: Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;">B</code> será <span class="math"><script type="math/tex">H_0:~todos~\beta_j=0</script></span> vs. <span class="math"><script type="math/tex">H_1:~al~menos~un~\beta_j \neq 0</script></span>, siendo:</p>
<ul>
<li>Modelo nulo: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\epsilon_{ijk}</script></span></li>
<li>Modelo alternativo: <span class="math"><script type="math/tex">y_{ijk}=\mu_0+\alpha_i+\beta_j+\epsilon_{ijk}</script></span>
Rechazaremos esta hipótesis nula cuando el estadístico F sea lo suficientemente grande. Bajo <span class="math"><script type="math/tex">H_0</script></span> <span class="math"><script type="math/tex">F\sim F_{J-1,IJ(K-1)}</script></span>.</li>
</ul>
<p>Para llevar a cabo las distintas pruebas se puede seguir el órden jerárquico. Primero se evalúa la interacción, si ésta no es significativa, entonces se evaluará el modelo aditivo. De no ser significativo, se evaluarán los modelos simples.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(additiveModel, interactionModel)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 1: time ~ poison + treat</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Model 2: time ~ poison + treat + poison:treat</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>1     42 1.05086                           </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>2     36 0.80073  6   0.25014 1.8743 0.1123</span></span></span>
</pre>
<p><strong>Ejercicio</strong>: compare estos resultados con los del anova sobre el modelo de  interacción.</p>
<p>A un nivel de significancia <span class="math"><script type="math/tex">\alpha=0.05</script></span> la interacción de los factores <em>Veneno</em> y <em>Tratamiento</em> no es significativa. Si comparamos ahora el modelo aditivo contra los dos modelos unifactoriales, veremos que este resulta significativo a dicho nivel.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; anova(additiveModel )</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Analysis of Variance Table</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Response: time</span></span></span>
<span class="syntax--text syntax--plain"><span>          </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>poison     2 1.03301 0.51651  20.643 5.704e-07 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>treat      3 0.92121 0.30707  12.273 6.697e-06 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals 42 1.05086 0.02502                      </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
</pre>
<p>Exploremos los resultados del modelo aditivo, y las medias estimadas para la diferencia entre los niveles de los efectos principales según la prueba de Tukey.</p>
<pre class="editor-colors lang-text"><span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; summary(additiveModel)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Call:</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>lm(formula = time ~ poison + treat, data = rats)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residuals:</span></span></span>
<span class="syntax--text syntax--plain"><span>     </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Min       1Q   Median       3Q      Max</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>-0.25167 -0.09625 -0.01490  0.06177  0.49833</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Coefficients:</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Estimate Std. Error t value Pr(&gt;|t|)    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>(Intercept)  0.45229    0.05592   8.088 4.22e-10 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>poisonII    -0.07312    0.05592  -1.308  0.19813    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>poisonIII   -0.34125    0.05592  -6.102 2.83e-07 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>treatB       0.36250    0.06458   5.614 1.43e-06 ***</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>treatC       0.07833    0.06458   1.213  0.23189    </span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>treatD       0.22000    0.06458   3.407  0.00146 **</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>---</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Residual standard error: 0.1582 on 42 degrees of freedom</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Multiple R-squared:  0.6503,	Adjusted R-squared:  0.6087</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>F-statistic: 15.62 on 5 and 42 DF,  p-value: 1.123e-08</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>&gt; TukeyHSD(aov(time ~ poison + treat, data = rats))</span></span></span>
<span class="syntax--text syntax--plain"><span>  </span><span class="syntax--meta syntax--paragraph syntax--text"><span>Tukey multiple comparisons of means</span></span></span>
<span class="syntax--text syntax--plain"><span>    </span><span class="syntax--meta syntax--paragraph syntax--text"><span>95% family-wise confidence level</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>Fit: aov(formula = time ~ poison + treat, data = rats)</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>$`poison`</span></span></span>
<span class="syntax--text syntax--plain"><span>            </span><span class="syntax--meta syntax--paragraph syntax--text"><span>diff        lwr        upr     p adj</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>II-I   -0.073125 -0.2089936  0.0627436 0.3989657</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>III-I  -0.341250 -0.4771186 -0.2053814 0.0000008</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>III-II -0.268125 -0.4039936 -0.1322564 0.0000606</span></span></span>
<span class="syntax--text syntax--plain"><span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>$treat</span></span></span>
<span class="syntax--text syntax--plain"><span>           </span><span class="syntax--meta syntax--paragraph syntax--text"><span>diff         lwr         upr     p adj</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>B-A  0.36250000  0.18976135  0.53523865 0.0000083</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C-A  0.07833333 -0.09440532  0.25107198 0.6221729</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-A  0.22000000  0.04726135  0.39273865 0.0076661</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>C-B -0.28416667 -0.45690532 -0.11142802 0.0004090</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-B -0.14250000 -0.31523865  0.03023865 0.1380432</span></span></span>
<span class="syntax--text syntax--plain"><span class="syntax--meta syntax--paragraph syntax--text"><span>D-C  0.14166667 -0.03107198  0.31440532 0.1416151</span></span></span>
</pre>
<p><img src="../Imagenes/tukeyPlotRats.png" alt="Figura17"></p>
<p><strong>Figura 17</strong>: Intervalos de confianza del 95% para la diferencia de media entre grupos, comparados de a dos, en base a los resultados de la Prueba de Tukey.</p>

  </body>
</html>
